<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>&lt;no title&gt; &mdash; py-lmd 1.0.2 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../../../_static/css/theme.css?v=19f00094" />
      <link rel="stylesheet" type="text/css" href="../../../_static/copybutton.css?v=76b2166b" />
      <link rel="stylesheet" type="text/css" href="../../../_static/custom.css?v=5c2dde8a" />
      <link rel="stylesheet" type="text/css" href="../../../_static/fonts.css?v=5583d106" />
      <link rel="stylesheet" type="text/css" href="../../../_static/nbsphinx-code-cells.css?v=2aa19091" />

  
  <!--[if lt IE 9]>
    <script src="../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../../../_static/jquery.js?v=5d32c60e"></script>
        <script src="../../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../../../_static/documentation_options.js?v=1ed6394b"></script>
        <script src="../../../_static/doctools.js?v=9a2dae69"></script>
        <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
        <script src="../../../_static/clipboard.min.js?v=a7894cd8"></script>
        <script src="../../../_static/copybutton.js?v=f281be69"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
        <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link href="../../../_static/style.css" rel="stylesheet" type="text/css">

</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../../index.html">
            
              <img src="../../../_static/py-lmd_logo.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../quickstart.html">1. Quick Start</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../quickstart.html#installation-from-github">1.1. Installation from Github</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../quickstart.html#generating-shapes">1.2. Generating Shapes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../quickstart.html#using-the-py-lmd-tools">1.3. Using the py-lmd tools</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../quickstart.html#numbers-and-letters">1.4. Numbers and Letters</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../quickstart.html#text">1.5. Text</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../segmentation_loader.html">2. Using Segmented Images</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../segmentation_loader.html#background">2.1. Background</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../segmentation_loader.html#different-coordinate-systems">2.2. Different Coordinate Systems</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../segmentation_loader.html#getting-started-with-the-segmentationloader">2.3. Getting started with the SegmentationLoader</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../segmentation_loader.html#overview-of-configuration">2.4. Overview of Configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../segmentation_loader.html#processing-order">2.5. Processing Order</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../example_notebooks.html">3. Example Notebooks</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../generate_xml_from_segmentation_mask.html">3.1. Generate a Cutting XML from segmentation mask using the Segmentation Loader.</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../generate_xml_from_segmentation_mask.html#Load-Segmentation-Mask">3.1.1. Load Segmentation Mask</a></li>
<li class="toctree-l3"><a class="reference internal" href="../generate_xml_from_segmentation_mask.html#Define-cell-sets">3.1.2. Define cell sets</a></li>
<li class="toctree-l3"><a class="reference internal" href="../generate_xml_from_segmentation_mask.html#Calibration-points">3.1.3. Calibration points</a></li>
<li class="toctree-l3"><a class="reference internal" href="../generate_xml_from_segmentation_mask.html#XML-generation">3.1.4. XML generation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../generate_xml_from_segmentation_mask.html#write-to-XML">3.1.5. write to XML</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../generate_xml_from_qupath_export.html">3.2. Generate cutting XML from exported results from QUPath</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../generate_xml_from_qupath_export.html#Import-libraries-and-define-helper-functions">3.2.1. Import libraries and define helper functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../generate_xml_from_qupath_export.html#Import-GEOjson-regions">3.2.2. Import GEOjson regions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../generate_xml_from_qupath_export.html#Calibration-points">3.2.3. Calibration points</a></li>
<li class="toctree-l3"><a class="reference internal" href="../generate_xml_from_qupath_export.html#Clean-up-Dataframe">3.2.4. Clean up Dataframe</a></li>
<li class="toctree-l3"><a class="reference internal" href="../generate_xml_from_qupath_export.html#Generate-shape-collection">3.2.5. Generate shape collection</a></li>
<li class="toctree-l3"><a class="reference internal" href="../generate_xml_from_qupath_export.html#write-to-XML">3.2.6. write to XML</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../generate_cutting_mask_svg.html">3.3. Convert SVG graphic into LMD excision instructions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../generate_cutting_mask_svg.html#Visualize-Results">3.3.1. Visualize Results</a></li>
<li class="toctree-l3"><a class="reference internal" href="../generate_cutting_mask_svg.html#Export-to-XML">3.3.2. Export to XML</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../modules.html">4. py-lmd Modules</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../modules.html#lmd-lib">4.1. lmd.lib</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../modules.html#collection">4.1.1. Collection</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../modules.html#lmd.lib.Collection"><code class="docutils literal notranslate"><span class="pre">Collection</span></code></a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../modules.html#lmd.lib.Collection.shapes"><code class="docutils literal notranslate"><span class="pre">Collection.shapes</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../modules.html#lmd.lib.Collection.calibration_points"><code class="docutils literal notranslate"><span class="pre">Collection.calibration_points</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../modules.html#lmd.lib.Collection.orientation_transform"><code class="docutils literal notranslate"><span class="pre">Collection.orientation_transform</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../modules.html#lmd.lib.Collection.add_shape"><code class="docutils literal notranslate"><span class="pre">Collection.add_shape()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../modules.html#lmd.lib.Collection.join"><code class="docutils literal notranslate"><span class="pre">Collection.join()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../modules.html#lmd.lib.Collection.load"><code class="docutils literal notranslate"><span class="pre">Collection.load()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../modules.html#lmd.lib.Collection.new_shape"><code class="docutils literal notranslate"><span class="pre">Collection.new_shape()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../modules.html#lmd.lib.Collection.plot"><code class="docutils literal notranslate"><span class="pre">Collection.plot()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../modules.html#lmd.lib.Collection.save"><code class="docutils literal notranslate"><span class="pre">Collection.save()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../modules.html#lmd.lib.Collection.stats"><code class="docutils literal notranslate"><span class="pre">Collection.stats()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../modules.html#lmd.lib.Collection.svg_to_lmd"><code class="docutils literal notranslate"><span class="pre">Collection.svg_to_lmd()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../modules.html#shape">4.1.2. Shape</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../modules.html#lmd.lib.Shape"><code class="docutils literal notranslate"><span class="pre">Shape</span></code></a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../modules.html#lmd.lib.Shape.from_xml"><code class="docutils literal notranslate"><span class="pre">Shape.from_xml()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../modules.html#lmd.lib.Shape.to_xml"><code class="docutils literal notranslate"><span class="pre">Shape.to_xml()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../modules.html#segmentationloader">4.1.3. SegmentationLoader</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../modules.html#lmd.lib.SegmentationLoader"><code class="docutils literal notranslate"><span class="pre">SegmentationLoader</span></code></a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../modules.html#lmd.lib.SegmentationLoader.check_cell_set_sanity"><code class="docutils literal notranslate"><span class="pre">SegmentationLoader.check_cell_set_sanity()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../modules.html#lmd.lib.SegmentationLoader.load_classes"><code class="docutils literal notranslate"><span class="pre">SegmentationLoader.load_classes()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../modules.html#module-lmd.tools">4.2. lmd.tools</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../modules.html#lmd.tools.ellipse"><code class="docutils literal notranslate"><span class="pre">ellipse()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../modules.html#lmd.tools.get_rotation_matrix"><code class="docutils literal notranslate"><span class="pre">get_rotation_matrix()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../modules.html#lmd.tools.glyph"><code class="docutils literal notranslate"><span class="pre">glyph()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../modules.html#lmd.tools.glyph_path"><code class="docutils literal notranslate"><span class="pre">glyph_path()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../modules.html#lmd.tools.makeCross"><code class="docutils literal notranslate"><span class="pre">makeCross()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../modules.html#lmd.tools.rectangle"><code class="docutils literal notranslate"><span class="pre">rectangle()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../modules.html#lmd.tools.text"><code class="docutils literal notranslate"><span class="pre">text()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">py-lmd</a>
      </nav>

      <div class="wy-nav-content">
<div class="git-ribbon">
  <a href="http://github.com/SwissDataScienceCenter" rel="me">Join us on GitHub</a>
</div>

        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">&lt;no title&gt;</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../../_sources/pages/notebooks/Image_Segmentation/Image_Segmentation_2.ipynb.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">reload_ext</span> autoreload
<span class="o">%</span><span class="k">autoreload</span> 2

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">PIL</span> <span class="kn">import</span> <span class="n">Image</span>
<span class="kn">from</span> <span class="nn">lmd.lib</span> <span class="kn">import</span> <span class="n">SegmentationLoader</span>

<span class="n">im</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;segmentation_cytosol.tiff&#39;</span><span class="p">)</span>
<span class="n">segmentation</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">im</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">uint32</span><span class="p">)</span>

<span class="n">all_classes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">segmentation</span><span class="p">)</span>

<span class="n">cell_sets</span> <span class="o">=</span> <span class="p">[{</span><span class="s2">&quot;classes&quot;</span><span class="p">:</span> <span class="n">all_classes</span><span class="p">,</span> <span class="s2">&quot;well&quot;</span><span class="p">:</span> <span class="s2">&quot;A1&quot;</span><span class="p">}]</span>

<span class="n">calibration_points</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1000</span><span class="p">],[</span><span class="mi">1000</span><span class="p">,</span><span class="mi">1000</span><span class="p">]])</span>

<span class="n">loader_config</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;orientation_transform&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]])</span>
<span class="p">}</span>

<span class="n">sl</span> <span class="o">=</span> <span class="n">SegmentationLoader</span><span class="p">(</span><span class="n">config</span> <span class="o">=</span> <span class="n">loader_config</span><span class="p">)</span>
<span class="n">shape_collection</span> <span class="o">=</span> <span class="n">sl</span><span class="p">(</span><span class="n">segmentation</span><span class="p">,</span>
                    <span class="n">cell_sets</span><span class="p">,</span>
                    <span class="n">calibration_points</span><span class="p">)</span>
<br/></pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Processing cell sets in serial
{&#39;classes&#39;: array([  0,   1,   2,   3,   4,   5,   6,   7,   8,   9,  10,  11,  12,
        13,  14,  15,  16,  17,  18,  19,  20,  21,  22,  23,  24,  25,
        26,  27,  28,  29,  30,  31,  32,  33,  34,  35,  36,  37,  38,
        39,  40,  41,  42,  43,  44,  45,  46,  47,  48,  49,  50,  51,
        52,  53,  54,  55,  56,  57,  58,  59,  60,  61,  62,  63,  64,
        65,  66,  67,  68,  69,  70,  71,  72,  73,  74,  75,  76,  77,
        78,  79,  80,  81,  82,  83,  84,  85,  86,  87,  88,  89,  90,
        91,  92,  93,  94,  95,  96,  97,  98,  99, 100, 101, 102, 103,
       104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116,
       117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129,
       130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142,
       143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155,
       156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168,
       169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181,
       182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194,
       195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 206, 207,
       208], dtype=uint32), &#39;well&#39;: &#39;A1&#39;, &#39;classes_loaded&#39;: array([  0,   1,   2,   3,   4,   5,   6,   7,   8,   9,  10,  11,  12,
        13,  14,  15,  16,  17,  18,  19,  20,  21,  22,  23,  24,  25,
        26,  27,  28,  29,  30,  31,  32,  33,  34,  35,  36,  37,  38,
        39,  40,  41,  42,  43,  44,  45,  46,  47,  48,  49,  50,  51,
        52,  53,  54,  55,  56,  57,  58,  59,  60,  61,  62,  63,  64,
        65,  66,  67,  68,  69,  70,  71,  72,  73,  74,  75,  76,  77,
        78,  79,  80,  81,  82,  83,  84,  85,  86,  87,  88,  89,  90,
        91,  92,  93,  94,  95,  96,  97,  98,  99, 100, 101, 102, 103,
       104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116,
       117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129,
       130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142,
       143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155,
       156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168,
       169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181,
       182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194,
       195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 206, 207,
       208], dtype=uint32)}
Merging intersecting shapes
center [array([nan, nan]), array([254.76721557, 698.56511976]), array([259.86753352, 409.69077611]), array([971.21844212, 459.56850369]), array([808.73684211, 946.92652085]), array([577.1920051 , 875.92642994]), array([265.03432589, 794.77894955]), array([578.27648202, 691.23663751]), array([486.59353664, 814.73441056]), array([664.48059521, 172.23929218]), array([335.05842391, 178.73686594]), array([858.7820765 , 882.90710383]), array([786.31519811, 978.77291543]), array([680.61261521, 845.88968894]), array([322.44490961,  43.24833492]), array([796.06549865, 887.22857143]), array([810.90721649, 119.59579848]), array([948.39975939, 934.37629973]), array([801.63590277,  43.43897049]), array([311.61059908, 759.73271889]), array([300.8918239 , 683.47127883]), array([590.62323391, 654.55180534]), array([914.94124773,  83.77286493]), array([512.23794489, 760.326062  ]), array([832.82862614, 822.127573  ]), array([768.82518641, 836.79756973]), array([258.92831921, 192.21327684]), array([949.87645286, 811.15368059]), array([214.41928934,  38.47055838]), array([863.43673852,  25.62980319]), array([282.42857143, 152.08109041]), array([112.8       , 243.51277955]), array([388.86646786, 753.79092114]), array([909.45791726,  21.53994294]), array([138.27740333, 189.54664775]), array([236.80669822, 316.89588642]), array([457.36380256, 742.83494385]), array([379.89669565, 684.66608696]), array([941.2333691, 853.8318133]), array([792.44200826, 764.04353352]), array([372.67908585, 810.7015556 ]), array([721.05746061,  94.54958295]), array([260.83376736,  86.98177083]), array([588.71497429, 504.77506427]), array([ 32.70134357, 716.76353167]), array([231.66963979, 537.12830189]), array([215.77467973, 108.74943482]), array([962.0181512 , 296.61002994]), array([310.76724592, 108.87756714]), array([410.45078106, 177.09273494]), array([169.25554608,  40.26834471]), array([923.33658945, 489.40217695]), array([268.27536809, 596.44846797]), array([581.38500421, 332.93723673]), array([846.78963186, 366.03681443]), array([290.69854338, 247.70234326]), array([ 72.49832916, 653.1641604 ]), array([ 75.20036765, 696.79181985]), array([380.91624041, 864.59910486]), array([683.28912072, 310.39940387]), array([180.93641405, 502.57486137]), array([783.74387378, 176.85968446]), array([650.83090564, 474.75585814]), array([204.72460757, 184.75738689]), array([116.71347518, 677.6141844 ]), array([659.7388535, 751.8      ]), array([752.50862069, 243.74956897]), array([452.41038118, 660.39497161]), array([710.61199455, 130.16310768]), array([682.2547736 , 536.30114566]), array([424.40207101, 706.56390533]), array([654.72253923,  45.76997147]), array([383.67131829, 952.36965558]), array([416.69281046, 534.00068799]), array([ 50.0992677 , 759.16219148]), array([843.37941034, 245.93813436]), array([520.67570216, 534.40496408]), array([384.6075188 , 213.39448622]), array([778.6497442 , 296.09130264]), array([697.75906555, 424.02824268]), array([ 96.42394015, 614.42679017]), array([453.77979275, 148.67764619]), array([474.19917127, 266.91712707]), array([199.55519481, 261.64805195]), array([519.2106309 , 578.78688525]), array([529.97727273, 956.77475248]), array([245.9480585 ,  18.07009581]), array([431.50352243, 339.79644049]), array([158.76799264, 880.09473442]), array([874.13658112, 397.48629839]), array([926.24421594, 137.66580977]), array([957.26803776, 388.85030344]), array([393.53264185, 410.5823673 ]), array([899.29216655, 315.17360621]), array([386.54567212, 909.79218189]), array([608.68261965, 292.45675903]), array([231.72485836, 970.42351275]), array([578.30427699, 106.36782077]), array([221.01459362, 844.40435564]), array([179.2144714 , 552.52079723]), array([769.27152956, 367.99742931]), array([718.46068848, 684.64300892]), array([201.7428262 , 611.43313481]), array([335.0674189 , 341.04118477]), array([356.5994152 , 268.59137427]), array([565.97991578, 588.4515711 ]), array([574.40467219, 449.94084401]), array([450.61693057, 947.58140479]), array([635.20668426, 252.88478452]), array([513.66171429, 480.142     ]), array([381.58330335, 348.5595538 ]), array([908.29996802, 417.78413815]), array([403.42892504, 269.10997171]), array([537.05441354,  18.37726723]), array([547.64211391, 298.70618839]), array([135.76751008, 817.7909791 ]), array([354.29659053, 617.42701092]), array([635.31606715, 659.51270983]), array([496.21041348, 623.23644717]), array([334.79747306, 888.24451877]), array([470.73956044, 198.42912088]), array([453.32396607, 382.22004242]), array([100.94282287, 844.13594562]), array([185.90365945, 402.46751307]), array([235.67703162, 477.42304677]), array([964.94067278, 584.58165138]), array([461.22279349, 424.802485  ]), array([497.39172185, 330.8884106 ]), array([153.26402039, 446.75928623]), array([544.15378356, 232.02196908]), array([633.5037679 , 708.16314996]), array([605.51348089, 563.60362173]), array([596.68126327, 236.25212314]), array([535.77403666, 372.71754583]), array([469.79950698, 893.12544508]), array([539.77293338, 902.50680153]), array([894.54804151, 265.09373954]), array([492.53878943, 118.28090367]), array([150.10315473, 764.42864296]), array([280.67527499, 318.69679579]), array([936.29722222, 614.82388889]), array([964.03179516,  36.31232414]), array([249.40557006, 235.84334204]), array([678.10257395, 247.59815597]), array([554.07054455, 738.76691419]), array([184.03546454, 978.92557443]), array([124.22962666, 729.06864713]), array([146.87087759,  83.31414198]), array([972.58095238, 126.09153439]), array([714.04631295, 722.30935252]), array([163.50893228, 685.37931034]), array([720.76768802, 202.97743733]), array([975.10969388, 340.38903061]), array([166.12504092, 241.30212766]), array([820.18096136, 326.97957901]), array([233.22795699, 263.9516129 ]), array([217.46316225, 418.18046358]), array([194.22410546, 310.92278719]), array([696.62274096,  80.9435241 ]), array([382.2967033 , 576.36087912]), array([441.12829595, 597.12239276]), array([533.67381974, 195.1276824 ]), array([178.78285498, 809.38595166]), array([855.73397762, 163.89928789]), array([464.37722729, 557.28118209]), array([912.91745432, 187.92249527]), array([935.19715514, 231.56500165]), array([968.15239764, 187.65995183]), array([763.04081633, 722.38566196]), array([725.42225392, 275.33701854]), array([444.3432971, 297.90625  ]), array([213.82225541, 760.29947722]), array([952.27046632,  91.03937824]), array([179.04979734, 732.22177186]), array([165.78054008, 595.49121303]), array([141.44200244, 642.3980464 ]), array([486.80028839, 375.27757751]), array([554.58455598, 132.73359073]), array([170.54516971, 112.28563969]), array([598.87787221,  31.98646522]), array([546.3887468,  81.5681403]), array([152.76290202, 390.15856395]), array([889.81424936, 153.80203562]), array([154.2       , 351.39382716]), array([984.93471235,  82.57724628]), array([406.09397278, 628.13642255]), array([809.81547354, 209.75233437]), array([798.55086957, 250.04434783]), array([873.55451406, 213.32659102]), array([286.73553985, 540.18219794]), array([323.21456386, 571.44742991]), array([639.00546177, 303.7611718 ]), array([188.02967848, 370.88458368]), array([589.31302326, 194.54139535]), array([294.49095201,  15.35877262]), array([359.34105471, 530.48841794]), array([581.11364968, 163.18922086]), array([532.8814638 , 150.67382657]), array([265.26037118, 658.06168122]), array([627.50404898, 116.03021924]), array([469.71370143, 230.32310838]), array([500.83231707, 167.61341463]), array([540.12784091, 260.06439394]), array([508.12910619, 225.76928953]), array([236.70909091, 582.25367965]), array([703.92302772, 974.94371002]), array([502.57092199, 925.78368794]), array([177.31826742, 139.25423729]), array([313.22151899, 799.16202532])]
length [0, 2672, 2461, 6496, 5852, 4703, 4836, 2058, 4394, 4973, 4416, 4575, 3382, 3472, 5255, 3710, 5141, 11637, 7693, 3038, 2385, 1274, 3302, 3484, 4178, 3621, 2832, 4646, 1970, 2134, 2898, 3130, 3018, 2804, 2819, 2747, 3829, 2875, 3728, 3147, 5207, 1079, 2304, 3112, 2605, 2915, 2654, 5344, 3798, 4033, 2344, 3583, 2513, 2374, 2662, 3158, 2394, 2176, 3128, 2684, 2705, 2979, 3158, 4332, 2115, 2355, 2320, 2466, 2201, 3666, 3380, 5608, 3368, 2907, 3687, 2069, 3062, 1995, 2541, 2868, 2807, 2702, 3620, 1540, 2013, 4444, 1983, 2697, 4349, 2299, 1945, 2966, 3278, 2834, 2507, 1191, 2824, 2455, 4454, 2308, 3112, 2353, 1847, 3545, 2736, 3087, 2654, 4926, 2274, 3500, 2779, 3127, 2828, 3308, 3652, 2727, 3021, 2085, 3265, 2691, 1820, 1886, 2501, 1339, 3827, 1635, 2334, 3020, 2746, 1229, 2654, 2485, 3768, 2673, 3651, 2867, 2987, 2346, 1997, 2091, 1800, 3554, 1149, 2603, 2424, 2002, 2491, 1789, 1890, 2224, 2407, 3590, 1568, 3055, 3183, 1860, 2416, 2655, 1328, 2275, 2541, 1864, 2648, 1966, 2301, 1587, 3023, 4567, 1911, 2804, 2208, 2678, 965, 1727, 2333, 1638, 1387, 1295, 1915, 3177, 2737, 1337, 1965, 1620, 1547, 3086, 2249, 2300, 2027, 3112, 2568, 2014, 1213, 2150, 1271, 2029, 1707, 1257, 1832, 5063, 1467, 1640, 1056, 1309, 1155, 4690, 564, 531, 790]
coords [array([], shape=(0, 2), dtype=uint32), array([[229, 665],
       [230, 665],
       [231, 665],
       ...,
       [275, 733],
       [276, 733],
       [272, 734]], dtype=uint32), array([[258, 377],
       [254, 378],
       [255, 378],
       ...,
       [257, 450],
       [258, 450],
       [254, 451]], dtype=uint32), array([[975, 395],
       [976, 395],
       [977, 395],
       ...,
       [998, 529],
       [999, 529],
       [999, 530]], dtype=uint32), array([[742, 890],
       [743, 890],
       [744, 890],
       ...,
       [898, 999],
       [899, 999],
       [900, 999]], dtype=uint32), array([[551, 833],
       [552, 833],
       [547, 834],
       ...,
       [588, 943],
       [587, 944],
       [588, 944]], dtype=uint32), array([[253, 744],
       [254, 744],
       [255, 744],
       ...,
       [269, 844],
       [270, 844],
       [271, 844]], dtype=uint32), array([[571, 667],
       [572, 667],
       [571, 668],
       ...,
       [583, 723],
       [584, 723],
       [585, 723]], dtype=uint32), array([[465, 774],
       [466, 774],
       [467, 774],
       ...,
       [508, 847],
       [509, 847],
       [510, 847]], dtype=uint32), array([[679, 117],
       [678, 118],
       [679, 118],
       ...,
       [676, 214],
       [677, 214],
       [678, 214]], dtype=uint32), array([[330, 131],
       [330, 132],
       [331, 132],
       ...,
       [344, 221],
       [339, 222],
       [340, 222]], dtype=uint32), array([[871, 842],
       [867, 843],
       [868, 843],
       ...,
       [840, 937],
       [839, 938],
       [840, 938]], dtype=uint32), array([[752, 943],
       [753, 943],
       [754, 943],
       ...,
       [846, 999],
       [847, 999],
       [848, 999]], dtype=uint32), array([[661, 811],
       [677, 811],
       [678, 811],
       ...,
       [686, 879],
       [690, 879],
       [691, 879]], dtype=uint32), array([[319,   0],
       [320,   0],
       [321,   0],
       ...,
       [312,  87],
       [313,  87],
       [314,  87]], dtype=uint32), array([[800, 848],
       [801, 848],
       [802, 848],
       ...,
       [824, 926],
       [825, 926],
       [826, 926]], dtype=uint32), array([[768,  85],
       [769,  85],
       [770,  85],
       ...,
       [810, 166],
       [811, 166],
       [812, 166]], dtype=uint32), array([[969, 869],
       [970, 869],
       [971, 869],
       ...,
       [997, 999],
       [998, 999],
       [999, 999]], dtype=uint32), array([[733,   0],
       [734,   0],
       [735,   0],
       ...,
       [836,  88],
       [837,  88],
       [838,  88]], dtype=uint32), array([[314, 728],
       [310, 729],
       [311, 729],
       ...,
       [330, 788],
       [331, 788],
       [330, 789]], dtype=uint32), array([[301, 645],
       [302, 645],
       [303, 645],
       ...,
       [286, 719],
       [287, 719],
       [287, 720]], dtype=uint32), array([[588, 635],
       [589, 635],
       [590, 635],
       ...,
       [607, 674],
       [608, 674],
       [609, 674]], dtype=uint32), array([[905,  46],
       [905,  47],
       [906,  47],
       ...,
       [913, 119],
       [914, 119],
       [915, 119]], dtype=uint32), array([[500, 716],
       [501, 716],
       [502, 716],
       ...,
       [532, 795],
       [514, 796],
       [515, 796]], dtype=uint32), array([[821, 787],
       [822, 787],
       [820, 788],
       ...,
       [822, 862],
       [823, 862],
       [820, 863]], dtype=uint32), array([[790, 792],
       [790, 793],
       [791, 793],
       ...,
       [751, 889],
       [752, 889],
       [753, 889]], dtype=uint32), array([[242, 154],
       [241, 155],
       [242, 155],
       ...,
       [234, 223],
       [235, 223],
       [234, 224]], dtype=uint32), array([[933, 762],
       [934, 762],
       [935, 762],
       ...,
       [999, 892],
       [998, 893],
       [999, 893]], dtype=uint32), array([[208,   1],
       [207,   2],
       [208,   2],
       ...,
       [221,  65],
       [222,  65],
       [223,  65]], dtype=uint32), array([[822,   0],
       [823,   0],
       [824,   0],
       ...,
       [893,  68],
       [885,  69],
       [886,  69]], dtype=uint32), array([[246, 124],
       [245, 125],
       [246, 125],
       ...,
       [297, 184],
       [293, 185],
       [294, 185]], dtype=uint32), array([[100, 193],
       [101, 193],
       [102, 193],
       ...,
       [147, 279],
       [142, 280],
       [143, 280]], dtype=uint32), array([[376, 715],
       [377, 715],
       [378, 715],
       ...,
       [419, 785],
       [420, 785],
       [421, 785]], dtype=uint32), array([[869,   0],
       [870,   0],
       [871,   0],
       ...,
       [924,  55],
       [925,  55],
       [926,  55]], dtype=uint32), array([[138, 161],
       [139, 161],
       [134, 162],
       ...,
       [151, 221],
       [136, 222],
       [150, 222]], dtype=uint32), array([[239, 277],
       [240, 277],
       [241, 277],
       ...,
       [217, 356],
       [226, 356],
       [227, 356]], dtype=uint32), array([[463, 703],
       [464, 703],
       [465, 703],
       ...,
       [429, 785],
       [430, 785],
       [429, 786]], dtype=uint32), array([[373, 654],
       [374, 654],
       [375, 654],
       ...,
       [390, 715],
       [391, 715],
       [392, 715]], dtype=uint32), array([[946, 828],
       [947, 828],
       [948, 828],
       ...,
       [950, 879],
       [951, 879],
       [952, 879]], dtype=uint32), array([[784, 735],
       [785, 735],
       [805, 735],
       ...,
       [816, 794],
       [815, 795],
       [816, 795]], dtype=uint32), array([[357, 773],
       [354, 774],
       [355, 774],
       ...,
       [320, 873],
       [321, 873],
       [320, 874]], dtype=uint32), array([[720,  75],
       [721,  75],
       [722,  75],
       ...,
       [697, 110],
       [698, 110],
       [699, 110]], dtype=uint32), array([[265,  51],
       [261,  52],
       [262,  52],
       ...,
       [266, 121],
       [267, 121],
       [266, 122]], dtype=uint32), array([[612, 458],
       [613, 458],
       [611, 459],
       ...,
       [588, 542],
       [589, 542],
       [590, 542]], dtype=uint32), array([[ 37, 676],
       [ 36, 677],
       [ 37, 677],
       ...,
       [ 29, 748],
       [ 30, 748],
       [ 31, 748]], dtype=uint32), array([[227, 504],
       [228, 504],
       [229, 504],
       ...,
       [223, 573],
       [224, 573],
       [225, 573]], dtype=uint32), array([[198,  77],
       [199,  77],
       [238,  77],
       ...,
       [214, 142],
       [215, 142],
       [216, 142]], dtype=uint32), array([[989, 243],
       [990, 243],
       [991, 243],
       ...,
       [950, 352],
       [951, 352],
       [950, 353]], dtype=uint32), array([[343,  74],
       [344,  74],
       [345,  74],
       ...,
       [351, 134],
       [352, 134],
       [353, 134]], dtype=uint32), array([[397, 134],
       [393, 135],
       [394, 135],
       ...,
       [422, 238],
       [423, 238],
       [424, 238]], dtype=uint32), array([[154,  13],
       [155,  13],
       [156,  13],
       ...,
       [173,  75],
       [174,  75],
       [175,  75]], dtype=uint32), array([[899, 449],
       [900, 449],
       [910, 449],
       ...,
       [961, 523],
       [962, 523],
       [963, 523]], dtype=uint32), array([[256, 555],
       [257, 555],
       [255, 556],
       ...,
       [264, 633],
       [265, 633],
       [261, 634]], dtype=uint32), array([[593, 299],
       [594, 299],
       [591, 300],
       ...,
       [589, 356],
       [585, 357],
       [586, 357]], dtype=uint32), array([[862, 328],
       [862, 329],
       [862, 330],
       ...,
       [846, 414],
       [847, 414],
       [846, 415]], dtype=uint32), array([[300, 212],
       [301, 212],
       [302, 212],
       ...,
       [293, 280],
       [288, 281],
       [289, 281]], dtype=uint32), array([[ 47, 612],
       [ 48, 612],
       [ 47, 613],
       ...,
       [ 51, 678],
       [ 52, 678],
       [ 53, 678]], dtype=uint32), array([[ 88, 676],
       [ 89, 676],
       [ 90, 676],
       ...,
       [ 81, 724],
       [ 82, 724],
       [ 83, 724]], dtype=uint32), array([[354, 830],
       [355, 830],
       [356, 830],
       ...,
       [371, 895],
       [373, 895],
       [374, 895]], dtype=uint32), array([[673, 279],
       [674, 279],
       [675, 279],
       ...,
       [675, 337],
       [676, 337],
       [677, 337]], dtype=uint32), array([[184, 471],
       [183, 472],
       [184, 472],
       ...,
       [193, 528],
       [194, 528],
       [195, 528]], dtype=uint32), array([[760, 147],
       [761, 147],
       [756, 148],
       ...,
       [772, 209],
       [773, 209],
       [774, 209]], dtype=uint32), array([[655, 435],
       [656, 435],
       [657, 435],
       ...,
       [667, 514],
       [666, 515],
       [667, 515]], dtype=uint32), array([[194, 147],
       [197, 147],
       [198, 147],
       ...,
       [204, 234],
       [205, 234],
       [206, 234]], dtype=uint32), array([[103, 641],
       [104, 641],
       [105, 641],
       ...,
       [112, 715],
       [113, 715],
       [112, 716]], dtype=uint32), array([[679, 721],
       [680, 721],
       [678, 722],
       ...,
       [656, 780],
       [657, 780],
       [653, 781]], dtype=uint32), array([[762, 204],
       [763, 204],
       [760, 205],
       ...,
       [758, 283],
       [759, 283],
       [760, 283]], dtype=uint32), array([[444, 630],
       [445, 630],
       [446, 630],
       ...,
       [467, 687],
       [461, 688],
       [462, 688]], dtype=uint32), array([[704, 108],
       [705, 108],
       [706, 108],
       ...,
       [706, 174],
       [707, 174],
       [705, 175]], dtype=uint32), array([[684, 490],
       [680, 491],
       [681, 491],
       ...,
       [667, 583],
       [668, 583],
       [669, 583]], dtype=uint32), array([[421, 667],
       [422, 667],
       [423, 667],
       ...,
       [415, 751],
       [416, 751],
       [417, 751]], dtype=uint32), array([[637,   0],
       [638,   0],
       [639,   0],
       ...,
       [678, 113],
       [679, 113],
       [679, 114]], dtype=uint32), array([[409, 924],
       [410, 924],
       [411, 924],
       ...,
       [383, 989],
       [384, 989],
       [380, 990]], dtype=uint32), array([[405, 503],
       [406, 503],
       [401, 504],
       ...,
       [418, 567],
       [419, 567],
       [413, 568]], dtype=uint32), array([[ 71, 715],
       [ 72, 715],
       [ 71, 716],
       ...,
       [ 44, 793],
       [ 39, 794],
       [ 40, 794]], dtype=uint32), array([[841, 209],
       [842, 209],
       [840, 210],
       ...,
       [839, 280],
       [840, 280],
       [841, 280]], dtype=uint32), array([[504, 508],
       [505, 508],
       [506, 508],
       ...,
       [490, 561],
       [491, 561],
       [492, 561]], dtype=uint32), array([[378, 163],
       [377, 164],
       [378, 164],
       ...,
       [386, 247],
       [387, 247],
       [388, 247]], dtype=uint32), array([[774, 263],
       [783, 263],
       [784, 263],
       ...,
       [765, 330],
       [766, 330],
       [767, 330]], dtype=uint32), array([[683, 388],
       [684, 388],
       [685, 388],
       ...,
       [726, 457],
       [727, 457],
       [728, 457]], dtype=uint32), array([[107, 584],
       [103, 585],
       [104, 585],
       ...,
       [114, 641],
       [115, 641],
       [114, 642]], dtype=uint32), array([[475, 101],
       [474, 102],
       [475, 102],
       ...,
       [451, 186],
       [449, 187],
       [450, 187]], dtype=uint32), array([[427, 237],
       [428, 237],
       [429, 237],
       ...,
       [486, 304],
       [487, 304],
       [477, 305]], dtype=uint32), array([[207, 234],
       [208, 234],
       [209, 234],
       ...,
       [186, 289],
       [187, 289],
       [188, 289]], dtype=uint32), array([[512, 555],
       [513, 555],
       [511, 556],
       ...,
       [531, 606],
       [532, 606],
       [533, 606]], dtype=uint32), array([[519, 924],
       [520, 924],
       [521, 924],
       ...,
       [538, 990],
       [539, 990],
       [540, 990]], dtype=uint32), array([[208,   0],
       [209,   0],
       [210,   0],
       ...,
       [249,  43],
       [245,  44],
       [246,  44]], dtype=uint32), array([[409, 312],
       [410, 312],
       [405, 313],
       ...,
       [423, 379],
       [424, 379],
       [425, 379]], dtype=uint32), array([[158, 843],
       [158, 844],
       [159, 844],
       ...,
       [162, 912],
       [164, 912],
       [174, 912]], dtype=uint32), array([[884, 359],
       [885, 359],
       [886, 359],
       ...,
       [872, 435],
       [873, 435],
       [873, 436]], dtype=uint32), array([[943, 108],
       [941, 109],
       [942, 109],
       ...,
       [933, 167],
       [932, 168],
       [933, 168]], dtype=uint32), array([[952, 352],
       [953, 352],
       [954, 352],
       ...,
       [941, 429],
       [942, 429],
       [943, 429]], dtype=uint32), array([[392, 378],
       [390, 379],
       [391, 379],
       ...,
       [384, 437],
       [385, 437],
       [386, 437]], dtype=uint32), array([[922, 282],
       [923, 282],
       [924, 282],
       ...,
       [910, 355],
       [911, 355],
       [907, 356]], dtype=uint32), array([[394, 888],
       [395, 888],
       [391, 889],
       ...,
       [350, 931],
       [351, 931],
       [352, 931]], dtype=uint32), array([[594, 274],
       [595, 274],
       [596, 274],
       ...,
       [612, 315],
       [613, 315],
       [614, 315]], dtype=uint32), array([[223, 941],
       [224, 941],
       [225, 941],
       ...,
       [244, 999],
       [245, 999],
       [246, 999]], dtype=uint32), array([[587,  68],
       [588,  68],
       [586,  69],
       ...,
       [586, 143],
       [587, 143],
       [588, 143]], dtype=uint32), array([[219, 798],
       [220, 798],
       [219, 799],
       ...,
       [207, 884],
       [208, 884],
       [207, 885]], dtype=uint32), array([[160, 526],
       [161, 526],
       [162, 526],
       ...,
       [202, 574],
       [203, 574],
       [204, 574]], dtype=uint32), array([[781, 331],
       [782, 331],
       [773, 332],
       ...,
       [771, 405],
       [772, 405],
       [773, 405]], dtype=uint32), array([[729, 663],
       [730, 663],
       [731, 663],
       ...,
       [702, 704],
       [703, 704],
       [704, 704]], dtype=uint32), array([[216, 588],
       [215, 589],
       [216, 589],
       ...,
       [204, 632],
       [206, 632],
       [207, 632]], dtype=uint32), array([[334, 299],
       [335, 299],
       [330, 300],
       ...,
       [337, 381],
       [338, 381],
       [339, 381]], dtype=uint32), array([[357, 228],
       [358, 228],
       [355, 229],
       ...,
       [383, 303],
       [384, 303],
       [385, 303]], dtype=uint32), array([[573, 544],
       [574, 544],
       [572, 545],
       ...,
       [540, 622],
       [541, 622],
       [541, 623]], dtype=uint32), array([[563, 420],
       [564, 420],
       [565, 420],
       ...,
       [575, 483],
       [576, 483],
       [577, 483]], dtype=uint32), array([[428, 894],
       [428, 895],
       [429, 895],
       ...,
       [472, 987],
       [473, 987],
       [474, 987]], dtype=uint32), array([[641, 212],
       [642, 212],
       [643, 212],
       ...,
       [630, 283],
       [631, 283],
       [632, 283]], dtype=uint32), array([[506, 437],
       [507, 437],
       [502, 438],
       ...,
       [492, 517],
       [493, 517],
       [489, 518]], dtype=uint32), array([[364, 307],
       [365, 307],
       [366, 307],
       ...,
       [373, 390],
       [374, 390],
       [375, 390]], dtype=uint32), array([[930, 376],
       [930, 377],
       [931, 377],
       ...,
       [916, 451],
       [914, 452],
       [915, 452]], dtype=uint32), array([[404, 230],
       [405, 230],
       [406, 230],
       ...,
       [391, 303],
       [386, 304],
       [387, 304]], dtype=uint32), array([[477,   0],
       [478,   0],
       [479,   0],
       ...,
       [556,  50],
       [557,  50],
       [558,  50]], dtype=uint32), array([[564, 262],
       [563, 263],
       [564, 263],
       ...,
       [542, 343],
       [541, 344],
       [542, 344]], dtype=uint32), array([[122, 779],
       [123, 779],
       [122, 780],
       ...,
       [127, 857],
       [128, 857],
       [126, 858]], dtype=uint32), array([[350, 577],
       [348, 578],
       [349, 578],
       ...,
       [356, 662],
       [357, 662],
       [358, 662]], dtype=uint32), array([[617, 637],
       [618, 637],
       [619, 637],
       ...,
       [627, 685],
       [628, 685],
       [629, 685]], dtype=uint32), array([[499, 589],
       [498, 590],
       [499, 590],
       ...,
       [491, 669],
       [492, 669],
       [491, 670]], dtype=uint32), array([[337, 856],
       [338, 856],
       [336, 857],
       ...,
       [342, 931],
       [343, 931],
       [344, 931]], dtype=uint32), array([[473, 175],
       [474, 175],
       [475, 175],
       ...,
       [476, 219],
       [477, 219],
       [478, 219]], dtype=uint32), array([[459, 353],
       [460, 353],
       [458, 354],
       ...,
       [466, 406],
       [467, 406],
       [468, 406]], dtype=uint32), array([[102, 800],
       [103, 800],
       [104, 800],
       ...,
       [106, 882],
       [105, 883],
       [106, 883]], dtype=uint32), array([[191, 381],
       [192, 381],
       [193, 381],
       ...,
       [188, 425],
       [188, 426],
       [188, 427]], dtype=uint32), array([[231, 435],
       [231, 436],
       [232, 436],
       ...,
       [257, 518],
       [258, 518],
       [259, 518]], dtype=uint32), array([[968, 560],
       [969, 560],
       [963, 561],
       ...,
       [963, 610],
       [964, 610],
       [963, 611]], dtype=uint32), array([[479, 400],
       [478, 401],
       [479, 401],
       ...,
       [459, 451],
       [454, 452],
       [455, 452]], dtype=uint32), array([[504, 298],
       [505, 298],
       [502, 299],
       ...,
       [530, 358],
       [531, 358],
       [532, 358]], dtype=uint32), array([[156, 413],
       [157, 413],
       [158, 413],
       ...,
       [156, 487],
       [157, 487],
       [158, 487]], dtype=uint32), array([[557, 212],
       [558, 212],
       [555, 213],
       ...,
       [530, 250],
       [531, 250],
       [532, 250]], dtype=uint32), array([[664, 671],
       [665, 671],
       [666, 671],
       ...,
       [636, 739],
       [637, 739],
       [638, 739]], dtype=uint32), array([[618, 531],
       [618, 532],
       [619, 532],
       ...,
       [602, 597],
       [603, 597],
       [599, 598]], dtype=uint32), array([[617, 208],
       [618, 208],
       [619, 208],
       ...,
       [591, 274],
       [592, 274],
       [593, 274]], dtype=uint32), array([[542, 345],
       [543, 345],
       [544, 345],
       ...,
       [528, 402],
       [529, 402],
       [530, 402]], dtype=uint32), array([[468, 865],
       [469, 865],
       [464, 866],
       ...,
       [484, 928],
       [485, 928],
       [485, 929]], dtype=uint32), array([[538, 848],
       [539, 848],
       [537, 849],
       ...,
       [575, 939],
       [576, 939],
       [577, 939]], dtype=uint32), array([[888, 228],
       [887, 229],
       [888, 229],
       ...,
       [877, 297],
       [878, 297],
       [879, 297]], dtype=uint32), array([[494,  85],
       [495,  85],
       [496,  85],
       ...,
       [498, 145],
       [499, 145],
       [495, 146]], dtype=uint32), array([[153, 735],
       [154, 735],
       [152, 736],
       ...,
       [145, 786],
       [146, 786],
       [147, 786]], dtype=uint32), array([[257, 294],
       [257, 295],
       [281, 295],
       ...,
       [275, 344],
       [276, 344],
       [277, 344]], dtype=uint32), array([[938, 585],
       [939, 585],
       [937, 586],
       ...,
       [944, 638],
       [945, 638],
       [946, 638]], dtype=uint32), array([[949,   0],
       [950,   0],
       [951,   0],
       ...,
       [963,  77],
       [964,  77],
       [965,  77]], dtype=uint32), array([[244, 215],
       [245, 215],
       [243, 216],
       ...,
       [253, 257],
       [254, 257],
       [255, 257]], dtype=uint32), array([[658, 214],
       [659, 214],
       [660, 214],
       ...,
       [694, 283],
       [695, 283],
       [694, 284]], dtype=uint32), array([[549, 703],
       [550, 703],
       [551, 703],
       ...,
       [551, 779],
       [552, 779],
       [551, 780]], dtype=uint32), array([[205, 950],
       [206, 950],
       [203, 951],
       ...,
       [209, 999],
       [210, 999],
       [211, 999]], dtype=uint32), array([[135, 696],
       [133, 697],
       [134, 697],
       ...,
       [118, 764],
       [119, 764],
       [118, 765]], dtype=uint32), array([[157,  58],
       [154,  59],
       [155,  59],
       ...,
       [142, 109],
       [143, 109],
       [142, 110]], dtype=uint32), array([[966, 105],
       [967, 105],
       [964, 106],
       ...,
       [962, 147],
       [982, 147],
       [983, 147]], dtype=uint32), array([[678, 692],
       [679, 692],
       [678, 693],
       ...,
       [728, 747],
       [729, 747],
       [730, 747]], dtype=uint32), array([[166, 653],
       [162, 654],
       [163, 654],
       ...,
       [172, 712],
       [173, 712],
       [174, 712]], dtype=uint32), array([[717, 165],
       [718, 165],
       [746, 165],
       ...,
       [716, 236],
       [717, 236],
       [718, 236]], dtype=uint32), array([[974, 318],
       [975, 318],
       [976, 318],
       ...,
       [963, 366],
       [962, 367],
       [963, 367]], dtype=uint32), array([[176, 208],
       [172, 209],
       [173, 209],
       ...,
       [166, 282],
       [167, 282],
       [168, 282]], dtype=uint32), array([[824, 296],
       [825, 296],
       [820, 297],
       ...,
       [810, 359],
       [808, 360],
       [809, 360]], dtype=uint32), array([[219, 227],
       [220, 227],
       [221, 227],
       ...,
       [221, 295],
       [222, 295],
       [220, 296]], dtype=uint32), array([[227, 377],
       [224, 378],
       [225, 378],
       ...,
       [205, 452],
       [202, 453],
       [203, 453]], dtype=uint32), array([[206, 279],
       [207, 279],
       [208, 279],
       ...,
       [214, 356],
       [215, 356],
       [213, 357]], dtype=uint32), array([[701,  54],
       [697,  55],
       [698,  55],
       ...,
       [682, 113],
       [683, 113],
       [680, 114]], dtype=uint32), array([[384, 552],
       [385, 552],
       [386, 552],
       ...,
       [385, 607],
       [386, 607],
       [385, 608]], dtype=uint32), array([[433, 563],
       [434, 563],
       [435, 563],
       ...,
       [461, 636],
       [458, 637],
       [459, 637]], dtype=uint32), array([[545, 169],
       [546, 169],
       [547, 169],
       ...,
       [525, 222],
       [526, 222],
       [527, 222]], dtype=uint32), array([[175, 775],
       [176, 775],
       [177, 775],
       ...,
       [175, 847],
       [176, 847],
       [177, 847]], dtype=uint32), array([[849, 135],
       [848, 136],
       [849, 136],
       ...,
       [862, 193],
       [860, 194],
       [861, 194]], dtype=uint32), array([[450, 525],
       [450, 526],
       [451, 526],
       ...,
       [478, 586],
       [462, 587],
       [474, 587]], dtype=uint32), array([[911, 162],
       [912, 162],
       [910, 163],
       ...,
       [903, 213],
       [904, 213],
       [905, 213]], dtype=uint32), array([[923, 206],
       [924, 206],
       [925, 206],
       ...,
       [953, 256],
       [954, 256],
       [950, 257]], dtype=uint32), array([[974, 139],
       [974, 140],
       [975, 140],
       ...,
       [991, 238],
       [992, 238],
       [990, 239]], dtype=uint32), array([[771, 698],
       [772, 698],
       [773, 698],
       ...,
       [757, 750],
       [758, 750],
       [759, 750]], dtype=uint32), array([[719, 236],
       [720, 236],
       [721, 236],
       ...,
       [747, 320],
       [748, 320],
       [747, 321]], dtype=uint32), array([[430, 263],
       [431, 263],
       [432, 263],
       ...,
       [422, 322],
       [423, 322],
       [420, 323]], dtype=uint32), array([[224, 731],
       [225, 731],
       [226, 731],
       ...,
       [207, 790],
       [208, 790],
       [209, 790]], dtype=uint32), array([[946,  71],
       [945,  72],
       [946,  72],
       ...,
       [950, 110],
       [951, 110],
       [952, 110]], dtype=uint32), array([[155, 712],
       [156, 712],
       [157, 712],
       ...,
       [181, 757],
       [182, 757],
       [183, 757]], dtype=uint32), array([[148, 573],
       [149, 573],
       [150, 573],
       ...,
       [162, 622],
       [163, 622],
       [164, 622]], dtype=uint32), array([[138, 621],
       [139, 621],
       [140, 621],
       ...,
       [147, 671],
       [142, 672],
       [143, 672]], dtype=uint32), array([[468, 347],
       [469, 347],
       [467, 348],
       ...,
       [488, 405],
       [488, 406],
       [489, 406]], dtype=uint32), array([[545, 105],
       [546, 105],
       [547, 105],
       ...,
       [576, 155],
       [574, 156],
       [575, 156]], dtype=uint32), array([[191,  80],
       [190,  81],
       [191,  81],
       ...,
       [163, 148],
       [164, 148],
       [165, 148]], dtype=uint32), array([[594,   0],
       [595,   0],
       [596,   0],
       ...,
       [599,  70],
       [600,  70],
       [601,  70]], dtype=uint32), array([[570,  39],
       [570,  40],
       [571,  40],
       ...,
       [520, 128],
       [521, 128],
       [522, 128]], dtype=uint32), array([[146, 366],
       [147, 366],
       [145, 367],
       ...,
       [151, 414],
       [152, 414],
       [153, 414]], dtype=uint32), array([[890, 115],
       [891, 115],
       [888, 116],
       ...,
       [885, 193],
       [886, 193],
       [885, 194]], dtype=uint32), array([[151, 327],
       [152, 327],
       [153, 327],
       ...,
       [135, 390],
       [136, 390],
       [132, 391]], dtype=uint32), array([[999,  44],
       [997,  45],
       [998,  45],
       ...,
       [997, 108],
       [998, 108],
       [999, 108]], dtype=uint32), array([[405, 590],
       [406, 590],
       [407, 590],
       ...,
       [412, 664],
       [413, 664],
       [414, 664]], dtype=uint32), array([[827, 173],
       [826, 174],
       [827, 174],
       ...,
       [807, 235],
       [808, 235],
       [809, 235]], dtype=uint32), array([[771, 222],
       [772, 222],
       [773, 222],
       ...,
       [814, 277],
       [815, 277],
       [816, 277]], dtype=uint32), array([[867, 183],
       [871, 183],
       [872, 183],
       ...,
       [873, 242],
       [874, 242],
       [875, 242]], dtype=uint32), array([[277, 498],
       [277, 499],
       [278, 499],
       ...,
       [291, 581],
       [292, 581],
       [293, 581]], dtype=uint32), array([[324, 537],
       [325, 537],
       [326, 537],
       ...,
       [301, 613],
       [299, 614],
       [300, 614]], dtype=uint32), array([[654, 271],
       [655, 271],
       [659, 271],
       ...,
       [607, 359],
       [604, 360],
       [605, 360]], dtype=uint32), array([[184, 349],
       [185, 349],
       [183, 350],
       ...,
       [205, 390],
       [206, 390],
       [205, 391]], dtype=uint32), array([[609, 168],
       [610, 168],
       [611, 168],
       ...,
       [575, 214],
       [576, 214],
       [577, 214]], dtype=uint32), array([[282,   0],
       [283,   0],
       [284,   0],
       ...,
       [289,  34],
       [290,  34],
       [291,  34]], dtype=uint32), array([[360, 501],
       [361, 501],
       [356, 502],
       ...,
       [358, 558],
       [359, 558],
       [377, 558]], dtype=uint32), array([[597, 139],
       [595, 140],
       [596, 140],
       ...,
       [566, 184],
       [567, 184],
       [568, 184]], dtype=uint32), array([[531, 125],
       [528, 126],
       [529, 126],
       ...,
       [534, 172],
       [535, 172],
       [536, 172]], dtype=uint32), array([[279, 639],
       [280, 639],
       [281, 639],
       ...,
       [276, 680],
       [277, 680],
       [277, 681]], dtype=uint32), array([[617,  59],
       [617,  60],
       [616,  61],
       ...,
       [616, 172],
       [617, 172],
       [616, 173]], dtype=uint32), array([[463, 212],
       [460, 213],
       [461, 213],
       ...,
       [467, 249],
       [468, 249],
       [469, 249]], dtype=uint32), array([[500, 145],
       [501, 145],
       [502, 145],
       ...,
       [503, 196],
       [504, 196],
       [500, 197]], dtype=uint32), array([[524, 245],
       [525, 245],
       [522, 246],
       ...,
       [533, 278],
       [534, 278],
       [533, 279]], dtype=uint32), array([[501, 197],
       [502, 197],
       [503, 197],
       ...,
       [506, 255],
       [507, 255],
       [506, 256]], dtype=uint32), array([[237, 563],
       [238, 563],
       [239, 563],
       ...,
       [242, 610],
       [243, 610],
       [242, 611]], dtype=uint32), array([[742, 922],
       [743, 922],
       [744, 922],
       ...,
       [755, 999],
       [756, 999],
       [757, 999]], dtype=uint32), array([[507, 912],
       [508, 912],
       [506, 913],
       ...,
       [491, 937],
       [492, 937],
       [493, 937]], dtype=uint32), array([[174, 127],
       [175, 127],
       [176, 127],
       ...,
       [179, 151],
       [180, 151],
       [176, 152]], dtype=uint32), array([[301, 785],
       [302, 785],
       [303, 785],
       ...,
       [318, 820],
       [317, 821],
       [318, 821]], dtype=uint32)]
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
dilating shapes:   0%|          | 0/209 [00:00&lt;?, ?it/s]
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">ValueError</span>                                Traceback (most recent call last)
Cell <span class="ansi-green-fg">In[3], line 22</span>
<span class="ansi-green-intense-fg ansi-bold">     17</span> loader_config <span style="color: rgb(98,98,98)">=</span> {
<span class="ansi-green-intense-fg ansi-bold">     18</span>     <span style="color: rgb(175,0,0)">&#39;</span><span style="color: rgb(175,0,0)">orientation_transform</span><span style="color: rgb(175,0,0)">&#39;</span>: np<span style="color: rgb(98,98,98)">.</span>array([[<span style="color: rgb(98,98,98)">0</span>, <span style="color: rgb(98,98,98)">-</span><span style="color: rgb(98,98,98)">1</span>],[<span style="color: rgb(98,98,98)">1</span>, <span style="color: rgb(98,98,98)">0</span>]])
<span class="ansi-green-intense-fg ansi-bold">     19</span> }
<span class="ansi-green-intense-fg ansi-bold">     21</span> sl <span style="color: rgb(98,98,98)">=</span> SegmentationLoader(config <span style="color: rgb(98,98,98)">=</span> loader_config)
<span class="ansi-green-fg">---&gt; 22</span> shape_collection <span style="color: rgb(98,98,98)">=</span> <span class="ansi-yellow-bg">sl</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">segmentation</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span>
<span class="ansi-green-intense-fg ansi-bold">     23</span> <span class="ansi-yellow-bg">                    </span><span class="ansi-yellow-bg">cell_sets</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span>
<span class="ansi-green-intense-fg ansi-bold">     24</span> <span class="ansi-yellow-bg">                    </span><span class="ansi-yellow-bg">calibration_points</span><span class="ansi-yellow-bg">)</span>

File <span class="ansi-green-fg">~/Documents/git/py-lmd/src/lmd/lib.py:666</span>, in <span class="ansi-cyan-fg">SegmentationLoader.__call__</span><span class="ansi-blue-fg">(self, input_segmentation, cell_sets, calibration_points, coords_lookup)</span>
<span class="ansi-green-intense-fg ansi-bold">    664</span>     collections <span style="color: rgb(98,98,98)">=</span> []
<span class="ansi-green-intense-fg ansi-bold">    665</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">for</span> i, cell_set <span class="ansi-bold" style="color: rgb(175,0,255)">in</span> <span style="color: rgb(0,135,0)">enumerate</span>(cell_sets):
<span class="ansi-green-fg">--&gt; 666</span>         collections<span style="color: rgb(98,98,98)">.</span>append(<span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">generate_cutting_data</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">i</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">cell_set</span><span class="ansi-yellow-bg">)</span>)
<span class="ansi-green-intense-fg ansi-bold">    668</span> <span class="ansi-bold" style="color: rgb(0,135,0)">return</span> reduce(<span class="ansi-bold" style="color: rgb(0,135,0)">lambda</span> a, b: a<span style="color: rgb(98,98,98)">.</span>join(b), collections)

File <span class="ansi-green-fg">~/Documents/git/py-lmd/src/lmd/lib.py:707</span>, in <span class="ansi-cyan-fg">SegmentationLoader.generate_cutting_data</span><span class="ansi-blue-fg">(self, i, cell_set)</span>
<span class="ansi-green-intense-fg ansi-bold">    705</span>     <span style="color: rgb(0,135,0)">print</span>(<span style="color: rgb(175,0,0)">&#39;</span><span style="color: rgb(175,0,0)">length</span><span style="color: rgb(175,0,0)">&#39;</span>, length)
<span class="ansi-green-intense-fg ansi-bold">    706</span>     <span style="color: rgb(0,135,0)">print</span>(<span style="color: rgb(175,0,0)">&#39;</span><span style="color: rgb(175,0,0)">coords</span><span style="color: rgb(175,0,0)">&#39;</span>, coords)
<span class="ansi-green-fg">--&gt; 707</span>     center, length, coords <span style="color: rgb(98,98,98)">=</span> <span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">merge_dilated_shapes</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">center</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">length</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">coords</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span>
<span class="ansi-green-intense-fg ansi-bold">    708</span> <span class="ansi-yellow-bg">                                                       </span><span class="ansi-yellow-bg">dilation</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">=</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">config</span><span class="ansi-yellow-bg">[</span><span class="ansi-yellow-bg" style="color: rgb(175,0,0)">&#39;</span><span class="ansi-yellow-bg" style="color: rgb(175,0,0)">shape_dilation</span><span class="ansi-yellow-bg" style="color: rgb(175,0,0)">&#39;</span><span class="ansi-yellow-bg">]</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-intense-fg ansi-bold">    709</span> <span class="ansi-yellow-bg">                                                       </span><span class="ansi-yellow-bg">erosion</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">=</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">config</span><span class="ansi-yellow-bg">[</span><span class="ansi-yellow-bg" style="color: rgb(175,0,0)">&#39;</span><span class="ansi-yellow-bg" style="color: rgb(175,0,0)">shape_erosion</span><span class="ansi-yellow-bg" style="color: rgb(175,0,0)">&#39;</span><span class="ansi-yellow-bg">]</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    711</span> <span style="color: rgb(95,135,135)"># Calculate dilation and erosion based on if merging was activated</span>
<span class="ansi-green-intense-fg ansi-bold">    712</span> dilation <span style="color: rgb(98,98,98)">=</span> <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>config[<span style="color: rgb(175,0,0)">&#39;</span><span style="color: rgb(175,0,0)">binary_smoothing</span><span style="color: rgb(175,0,0)">&#39;</span>] <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>config[<span style="color: rgb(175,0,0)">&#39;</span><span style="color: rgb(175,0,0)">join_intersecting</span><span style="color: rgb(175,0,0)">&#39;</span>] <span class="ansi-bold" style="color: rgb(0,135,0)">else</span> <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>config[<span style="color: rgb(175,0,0)">&#39;</span><span style="color: rgb(175,0,0)">binary_smoothing</span><span style="color: rgb(175,0,0)">&#39;</span>] <span style="color: rgb(98,98,98)">+</span> <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>config[<span style="color: rgb(175,0,0)">&#39;</span><span style="color: rgb(175,0,0)">shape_dilation</span><span style="color: rgb(175,0,0)">&#39;</span>]

File <span class="ansi-green-fg">~/Documents/git/py-lmd/src/lmd/lib.py:840</span>, in <span class="ansi-cyan-fg">SegmentationLoader.merge_dilated_shapes</span><span class="ansi-blue-fg">(self, input_center, input_length, input_coords, dilation, erosion)</span>
<span class="ansi-green-intense-fg ansi-bold">    838</span> <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>config[<span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">threads</span><span style="color: rgb(175,0,0)">&#34;</span>] <span style="color: rgb(98,98,98)">==</span> <span style="color: rgb(98,98,98)">1</span>:
<span class="ansi-green-intense-fg ansi-bold">    839</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">for</span> coord <span class="ansi-bold" style="color: rgb(175,0,255)">in</span> tqdm(input_coords, desc <span style="color: rgb(98,98,98)">=</span> <span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">dilating shapes</span><span style="color: rgb(175,0,0)">&#34;</span>):
<span class="ansi-green-fg">--&gt; 840</span>         dilated_coords<span style="color: rgb(98,98,98)">.</span>append(<span class="ansi-yellow-bg">tranform_to_map</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">coord</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">dilation</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">=</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">dilation</span><span class="ansi-yellow-bg">)</span>)
<span class="ansi-green-intense-fg ansi-bold">    842</span> <span class="ansi-bold" style="color: rgb(0,135,0)">else</span>:
<span class="ansi-green-intense-fg ansi-bold">    843</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">with</span> mp<span style="color: rgb(98,98,98)">.</span>get_context(<span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>context)<span style="color: rgb(98,98,98)">.</span>Pool(processes<span style="color: rgb(98,98,98)">=</span><span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>config[<span style="color: rgb(175,0,0)">&#39;</span><span style="color: rgb(175,0,0)">processes</span><span style="color: rgb(175,0,0)">&#39;</span>]) <span class="ansi-bold" style="color: rgb(0,135,0)">as</span> pool:

File <span class="ansi-green-fg">~/Documents/git/py-lmd/src/lmd/lib.py:1004</span>, in <span class="ansi-cyan-fg">tranform_to_map</span><span class="ansi-blue-fg">(coords, dilation, erosion, coord_format, debug)</span>
<span class="ansi-green-intense-fg ansi-bold">   1000</span> coords <span style="color: rgb(98,98,98)">=</span> np<span style="color: rgb(98,98,98)">.</span>array(coords)<span style="color: rgb(98,98,98)">.</span>astype(<span style="color: rgb(0,135,0)">int</span>)
<span class="ansi-green-intense-fg ansi-bold">   1003</span> <span style="color: rgb(95,135,135)"># top left offset used for creating the offset map</span>
<span class="ansi-green-fg">-&gt; 1004</span> offset <span style="color: rgb(98,98,98)">=</span> <span class="ansi-yellow-bg">np</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">min</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">coords</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">axis</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">=</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">0</span><span class="ansi-yellow-bg">)</span> <span style="color: rgb(98,98,98)">-</span> safety_offset <span style="color: rgb(98,98,98)">-</span> dilation_offset
<span class="ansi-green-intense-fg ansi-bold">   1005</span> mat <span style="color: rgb(98,98,98)">=</span> np<span style="color: rgb(98,98,98)">.</span>array([offset, [<span style="color: rgb(98,98,98)">0</span>,<span style="color: rgb(98,98,98)">0</span>]])
<span class="ansi-green-intense-fg ansi-bold">   1006</span> offset <span style="color: rgb(98,98,98)">=</span> np<span style="color: rgb(98,98,98)">.</span>max(mat, axis<span style="color: rgb(98,98,98)">=</span><span style="color: rgb(98,98,98)">0</span>)

File <span class="ansi-green-fg">~/miniconda3/envs/pylmd/lib/python3.9/site-packages/numpy/_core/fromnumeric.py:3042</span>, in <span class="ansi-cyan-fg">min</span><span class="ansi-blue-fg">(a, axis, out, keepdims, initial, where)</span>
<span class="ansi-green-intense-fg ansi-bold">   2925</span> <span style="color: rgb(175,0,255)">@array_function_dispatch</span>(_min_dispatcher)
<span class="ansi-green-intense-fg ansi-bold">   2926</span> <span class="ansi-bold" style="color: rgb(0,135,0)">def</span> <span style="color: rgb(0,0,255)">min</span>(a, axis<span style="color: rgb(98,98,98)">=</span><span class="ansi-bold" style="color: rgb(0,135,0)">None</span>, out<span style="color: rgb(98,98,98)">=</span><span class="ansi-bold" style="color: rgb(0,135,0)">None</span>, keepdims<span style="color: rgb(98,98,98)">=</span>np<span style="color: rgb(98,98,98)">.</span>_NoValue, initial<span style="color: rgb(98,98,98)">=</span>np<span style="color: rgb(98,98,98)">.</span>_NoValue,
<span class="ansi-green-intense-fg ansi-bold">   2927</span>         where<span style="color: rgb(98,98,98)">=</span>np<span style="color: rgb(98,98,98)">.</span>_NoValue):
<span class="ansi-green-intense-fg ansi-bold">   2928</span> <span style="color: rgb(188,188,188)">    </span><span style="color: rgb(175,0,0)">&#34;&#34;&#34;</span>
<span class="ansi-green-intense-fg ansi-bold">   2929</span> <span style="color: rgb(175,0,0)">    Return the minimum of an array or minimum along an axis.</span>
<span class="ansi-green-intense-fg ansi-bold">   2930</span>
<span class="ansi-green-fg">   (...)</span>
<span class="ansi-green-intense-fg ansi-bold">   3040</span> <span style="color: rgb(175,0,0)">    6</span>
<span class="ansi-green-intense-fg ansi-bold">   3041</span> <span style="color: rgb(175,0,0)">    &#34;&#34;&#34;</span>
<span class="ansi-green-fg">-&gt; 3042</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">return</span> <span class="ansi-yellow-bg">_wrapreduction</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">a</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">np</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">minimum</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg" style="color: rgb(175,0,0)">&#39;</span><span class="ansi-yellow-bg" style="color: rgb(175,0,0)">min</span><span class="ansi-yellow-bg" style="color: rgb(175,0,0)">&#39;</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">axis</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg ansi-bold" style="color: rgb(0,135,0)">None</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">out</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-intense-fg ansi-bold">   3043</span> <span class="ansi-yellow-bg">                          </span><span class="ansi-yellow-bg">keepdims</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">=</span><span class="ansi-yellow-bg">keepdims</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">initial</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">=</span><span class="ansi-yellow-bg">initial</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">where</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">=</span><span class="ansi-yellow-bg">where</span><span class="ansi-yellow-bg">)</span>

File <span class="ansi-green-fg">~/miniconda3/envs/pylmd/lib/python3.9/site-packages/numpy/_core/fromnumeric.py:86</span>, in <span class="ansi-cyan-fg">_wrapreduction</span><span class="ansi-blue-fg">(obj, ufunc, method, axis, dtype, out, **kwargs)</span>
<span class="ansi-green-intense-fg ansi-bold">     83</span>         <span class="ansi-bold" style="color: rgb(0,135,0)">else</span>:
<span class="ansi-green-intense-fg ansi-bold">     84</span>             <span class="ansi-bold" style="color: rgb(0,135,0)">return</span> reduction(axis<span style="color: rgb(98,98,98)">=</span>axis, out<span style="color: rgb(98,98,98)">=</span>out, <span style="color: rgb(98,98,98)">*</span><span style="color: rgb(98,98,98)">*</span>passkwargs)
<span class="ansi-green-fg">---&gt; 86</span> <span class="ansi-bold" style="color: rgb(0,135,0)">return</span> <span class="ansi-yellow-bg">ufunc</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">reduce</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">obj</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">axis</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">dtype</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">out</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">*</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">*</span><span class="ansi-yellow-bg">passkwargs</span><span class="ansi-yellow-bg">)</span>

<span class="ansi-red-fg">ValueError</span>: zero-size array to reduction operation minimum which has no identity
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><br/><br/><span></span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
100%|| 208/208 [00:00&lt;00:00, 210.22it/s]
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">PIL</span> <span class="kn">import</span> <span class="n">Image</span>
<span class="kn">from</span> <span class="nn">lmd.lib</span> <span class="kn">import</span> <span class="n">Collection</span><span class="p">,</span> <span class="n">Shape</span><span class="p">,</span> <span class="n">SegmentationLoader</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

<span class="n">im</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;segmentation_cytosol.tiff&#39;</span><span class="p">)</span>
<span class="n">segmentation</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">im</span><span class="p">)</span>

<span class="n">im</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;channels.npy&#39;</span><span class="p">)</span>
<span class="n">dapi</span> <span class="o">=</span> <span class="n">im</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="n">all_classes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">segmentation</span><span class="p">)</span>
<span class="n">indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">all_classes</span><span class="p">),</span> <span class="n">size</span><span class="o">=</span><span class="mi">100</span><span class="p">))</span>
<span class="n">classes_to_cut</span> <span class="o">=</span> <span class="n">all_classes</span> <span class="c1">#np.array_split(all_classes[indices],2)</span>

<span class="n">cell_sets</span> <span class="o">=</span> <span class="p">[{</span><span class="s2">&quot;classes&quot;</span><span class="p">:</span> <span class="n">classes_to_cut</span><span class="p">,</span> <span class="s2">&quot;well&quot;</span><span class="p">:</span> <span class="s2">&quot;A1&quot;</span><span class="p">}]</span>

<span class="n">calibration_points</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1000</span><span class="p">],[</span><span class="mi">1000</span><span class="p">,</span><span class="mi">1000</span><span class="p">]])</span>

<span class="n">loader_config</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;orientation_transform&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]]),</span>
    <span class="s1">&#39;shape_dilation&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
    <span class="s1">&#39;binary_smoothing&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
    <span class="s1">&#39;poly_compression_factor&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="s1">&#39;path_optimization&#39;</span><span class="p">:</span> <span class="s1">&#39;none&#39;</span><span class="p">,</span>
    <span class="s1">&#39;convolution_smoothing&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span>
    <span class="s1">&#39;join_intersecting&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
    <span class="s1">&#39;background_image&#39;</span><span class="p">:</span> <span class="n">dapi</span>
<span class="p">}</span>

<span class="n">sl</span> <span class="o">=</span> <span class="n">SegmentationLoader</span><span class="p">(</span><span class="n">config</span> <span class="o">=</span> <span class="n">loader_config</span><span class="p">,</span> <span class="n">verbose</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="n">shape_collection</span> <span class="o">=</span> <span class="n">sl</span><span class="p">(</span><span class="n">segmentation</span><span class="p">,</span>
                    <span class="n">cell_sets</span><span class="p">,</span>
                    <span class="n">calibration_points</span><span class="p">)</span>

<span class="n">shape_collection</span><span class="o">.</span><span class="n">stats</span><span class="p">()</span>
<span class="n">shape_collection</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">calibration</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">fig_size</span> <span class="o">=</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<br/><br/><br/></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">FileNotFoundError</span>                         Traceback (most recent call last)
Cell <span class="ansi-green-fg">In[2], line 9</span>
<span class="ansi-green-intense-fg ansi-bold">      6</span> im <span style="color: rgb(98,98,98)">=</span> Image<span style="color: rgb(98,98,98)">.</span>open(<span style="color: rgb(175,0,0)">&#39;</span><span style="color: rgb(175,0,0)">segmentation_cytosol.tiff</span><span style="color: rgb(175,0,0)">&#39;</span>)
<span class="ansi-green-intense-fg ansi-bold">      7</span> segmentation <span style="color: rgb(98,98,98)">=</span> np<span style="color: rgb(98,98,98)">.</span>array(im)
<span class="ansi-green-fg">----&gt; 9</span> im <span style="color: rgb(98,98,98)">=</span> <span class="ansi-yellow-bg">np</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">load</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg" style="color: rgb(175,0,0)">&#39;</span><span class="ansi-yellow-bg" style="color: rgb(175,0,0)">channels.npy</span><span class="ansi-yellow-bg" style="color: rgb(175,0,0)">&#39;</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-intense-fg ansi-bold">     10</span> dapi <span style="color: rgb(98,98,98)">=</span> im[<span style="color: rgb(98,98,98)">0</span>]
<span class="ansi-green-intense-fg ansi-bold">     12</span> all_classes <span style="color: rgb(98,98,98)">=</span> np<span style="color: rgb(98,98,98)">.</span>unique(segmentation)

File <span class="ansi-green-fg">~/miniconda3/envs/pylmd/lib/python3.9/site-packages/numpy/lib/_npyio_impl.py:455</span>, in <span class="ansi-cyan-fg">load</span><span class="ansi-blue-fg">(file, mmap_mode, allow_pickle, fix_imports, encoding, max_header_size)</span>
<span class="ansi-green-intense-fg ansi-bold">    453</span>     own_fid <span style="color: rgb(98,98,98)">=</span> <span class="ansi-bold" style="color: rgb(0,135,0)">False</span>
<span class="ansi-green-intense-fg ansi-bold">    454</span> <span class="ansi-bold" style="color: rgb(0,135,0)">else</span>:
<span class="ansi-green-fg">--&gt; 455</span>     fid <span style="color: rgb(98,98,98)">=</span> stack<span style="color: rgb(98,98,98)">.</span>enter_context(<span class="ansi-yellow-bg" style="color: rgb(0,135,0)">open</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">os</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">fspath</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">file</span><span class="ansi-yellow-bg">)</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg" style="color: rgb(175,0,0)">&#34;</span><span class="ansi-yellow-bg" style="color: rgb(175,0,0)">rb</span><span class="ansi-yellow-bg" style="color: rgb(175,0,0)">&#34;</span><span class="ansi-yellow-bg">)</span>)
<span class="ansi-green-intense-fg ansi-bold">    456</span>     own_fid <span style="color: rgb(98,98,98)">=</span> <span class="ansi-bold" style="color: rgb(0,135,0)">True</span>
<span class="ansi-green-intense-fg ansi-bold">    458</span> <span style="color: rgb(95,135,135)"># Code to distinguish from NumPy binary files and pickles.</span>

<span class="ansi-red-fg">FileNotFoundError</span>: [Errno 2] No such file or directory: &#39;channels.npy&#39;
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">PIL</span> <span class="kn">import</span> <span class="n">Image</span>
<span class="kn">from</span> <span class="nn">lmd.lib</span> <span class="kn">import</span> <span class="n">Collection</span><span class="p">,</span> <span class="n">Shape</span><span class="p">,</span> <span class="n">SegmentationLoader</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

<span class="n">im</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;segmentation_cytosol.tiff&#39;</span><span class="p">)</span>
<span class="n">segmentation</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">im</span><span class="p">)</span>

<span class="n">im</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;channels.npy&#39;</span><span class="p">)</span>
<span class="n">dapi</span> <span class="o">=</span> <span class="n">im</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="n">all_classes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">segmentation</span><span class="p">)</span>
<span class="n">indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">all_classes</span><span class="p">),</span> <span class="n">size</span><span class="o">=</span><span class="mi">100</span><span class="p">))</span>
<span class="n">classes_to_cut</span> <span class="o">=</span> <span class="p">[</span><span class="mi">13</span><span class="p">,</span><span class="mi">15</span><span class="p">,</span><span class="mi">23</span><span class="p">,</span><span class="mi">24</span><span class="p">,</span><span class="mi">25</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">36</span><span class="p">]</span>


<span class="n">cell_sets</span> <span class="o">=</span> <span class="p">[{</span><span class="s2">&quot;classes&quot;</span><span class="p">:</span> <span class="n">classes_to_cut</span><span class="p">,</span> <span class="s2">&quot;well&quot;</span><span class="p">:</span> <span class="s2">&quot;A1&quot;</span><span class="p">}]</span>

<span class="n">calibration_points</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1000</span><span class="p">],[</span><span class="mi">1000</span><span class="p">,</span><span class="mi">1000</span><span class="p">]])</span>

<span class="n">loader_config</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;orientation_transform&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]]),</span>
    <span class="s1">&#39;shape_dilation&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
    <span class="s1">&#39;binary_smoothing&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
    <span class="s1">&#39;poly_compression_factor&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="s1">&#39;path_optimization&#39;</span><span class="p">:</span> <span class="s1">&#39;none&#39;</span><span class="p">,</span>
    <span class="s1">&#39;convolution_smoothing&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span>
    <span class="s1">&#39;join_intersecting&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">}</span>

<span class="n">sl</span> <span class="o">=</span> <span class="n">SegmentationLoader</span><span class="p">(</span><span class="n">config</span> <span class="o">=</span> <span class="n">loader_config</span><span class="p">,</span> <span class="n">verbose</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
<span class="n">shape_collection</span> <span class="o">=</span> <span class="n">sl</span><span class="p">(</span><span class="n">segmentation</span><span class="p">,</span>
                    <span class="n">cell_sets</span><span class="p">,</span>
                    <span class="n">calibration_points</span><span class="p">)</span>

<span class="n">shape_collection</span><span class="o">.</span><span class="n">stats</span><span class="p">()</span>
<span class="n">shape_collection</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">calibration</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">fig_size</span> <span class="o">=</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>


<span class="n">loader_config</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;orientation_transform&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]]),</span>
    <span class="s1">&#39;shape_dilation&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
    <span class="s1">&#39;binary_smoothing&#39;</span><span class="p">:</span> <span class="mi">20</span><span class="p">,</span>
    <span class="s1">&#39;poly_compression_factor&#39;</span><span class="p">:</span> <span class="mi">30</span><span class="p">,</span>
    <span class="s1">&#39;path_optimization&#39;</span><span class="p">:</span> <span class="s1">&#39;none&#39;</span><span class="p">,</span>
    <span class="s1">&#39;convolution_smoothing&#39;</span><span class="p">:</span><span class="mi">40</span><span class="p">,</span>
    <span class="s1">&#39;join_intersecting&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">}</span>

<span class="n">sl</span> <span class="o">=</span> <span class="n">SegmentationLoader</span><span class="p">(</span><span class="n">config</span> <span class="o">=</span> <span class="n">loader_config</span><span class="p">,</span> <span class="n">verbose</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
<span class="n">shape_collection</span> <span class="o">=</span> <span class="n">sl</span><span class="p">(</span><span class="n">segmentation</span><span class="p">,</span>
                    <span class="n">cell_sets</span><span class="p">,</span>
                    <span class="n">calibration_points</span><span class="p">)</span>

<span class="n">shape_collection</span><span class="o">.</span><span class="n">stats</span><span class="p">()</span>
<span class="n">shape_collection</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">calibration</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">fig_size</span> <span class="o">=</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;dots&#39;</span><span class="p">)</span>
<br/><br/></pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">PIL</span> <span class="kn">import</span> <span class="n">Image</span>
<span class="kn">from</span> <span class="nn">lmd.lib</span> <span class="kn">import</span> <span class="n">Collection</span><span class="p">,</span> <span class="n">Shape</span><span class="p">,</span> <span class="n">SegmentationLoader</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

<span class="n">im</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;segmentation_cytosol.tiff&#39;</span><span class="p">)</span>
<span class="n">segmentation</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">im</span><span class="p">)</span>

<span class="n">im</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;channels.npy&#39;</span><span class="p">)</span>
<span class="n">dapi</span> <span class="o">=</span> <span class="n">im</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="n">all_classes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">segmentation</span><span class="p">)</span>
<span class="n">indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">all_classes</span><span class="p">),</span> <span class="n">size</span><span class="o">=</span><span class="mi">100</span><span class="p">))</span>
<span class="n">classes_to_cut</span> <span class="o">=</span> <span class="p">[</span><span class="mi">13</span><span class="p">,</span><span class="mi">15</span><span class="p">,</span><span class="mi">23</span><span class="p">,</span><span class="mi">24</span><span class="p">,</span><span class="mi">25</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">36</span><span class="p">]</span>


<span class="n">cell_sets</span> <span class="o">=</span> <span class="p">[{</span><span class="s2">&quot;classes&quot;</span><span class="p">:</span> <span class="n">classes_to_cut</span><span class="p">,</span> <span class="s2">&quot;well&quot;</span><span class="p">:</span> <span class="s2">&quot;A1&quot;</span><span class="p">}]</span>

<span class="n">calibration_points</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1000</span><span class="p">],[</span><span class="mi">1000</span><span class="p">,</span><span class="mi">1000</span><span class="p">]])</span>

<span class="n">loader_config</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;orientation_transform&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]]),</span>
    <span class="s1">&#39;shape_dilation&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
    <span class="s1">&#39;binary_smoothing&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
    <span class="s1">&#39;poly_compression_factor&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="s1">&#39;path_optimization&#39;</span><span class="p">:</span> <span class="s1">&#39;hilbert&#39;</span><span class="p">,</span>
    <span class="s1">&#39;convolution_smoothing&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span>
    <span class="s1">&#39;join_intersecting&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
    <span class="s1">&#39;background_image&#39;</span><span class="p">:</span> <span class="n">dapi</span>
<span class="p">}</span>

<span class="n">sl</span> <span class="o">=</span> <span class="n">SegmentationLoader</span><span class="p">(</span><span class="n">config</span> <span class="o">=</span> <span class="n">loader_config</span><span class="p">,</span> <span class="n">verbose</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
<span class="n">shape_collection</span> <span class="o">=</span> <span class="n">sl</span><span class="p">(</span><span class="n">segmentation</span><span class="p">,</span>
                    <span class="n">cell_sets</span><span class="p">,</span>
                    <span class="n">calibration_points</span><span class="p">)</span>

<span class="n">shape_collection</span><span class="o">.</span><span class="n">stats</span><span class="p">()</span>
<span class="n">shape_collection</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">calibration</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">fig_size</span> <span class="o">=</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="n">save_name</span><span class="o">=</span><span class="s1">&#39;conv1.png&#39;</span><span class="p">)</span>

<span class="n">loader_config</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;orientation_transform&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]]),</span>
    <span class="s1">&#39;shape_dilation&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
    <span class="s1">&#39;binary_smoothing&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
    <span class="s1">&#39;poly_compression_factor&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="s1">&#39;path_optimization&#39;</span><span class="p">:</span> <span class="s1">&#39;hilbert&#39;</span><span class="p">,</span>
    <span class="s1">&#39;convolution_smoothing&#39;</span><span class="p">:</span><span class="mi">40</span><span class="p">,</span>
    <span class="s1">&#39;join_intersecting&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
    <span class="s1">&#39;background_image&#39;</span><span class="p">:</span> <span class="n">dapi</span>
<span class="p">}</span>

<span class="n">sl</span> <span class="o">=</span> <span class="n">SegmentationLoader</span><span class="p">(</span><span class="n">config</span> <span class="o">=</span> <span class="n">loader_config</span><span class="p">,</span> <span class="n">verbose</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
<span class="n">shape_collection</span> <span class="o">=</span> <span class="n">sl</span><span class="p">(</span><span class="n">segmentation</span><span class="p">,</span>
                    <span class="n">cell_sets</span><span class="p">,</span>
                    <span class="n">calibration_points</span><span class="p">)</span>

<span class="n">shape_collection</span><span class="o">.</span><span class="n">stats</span><span class="p">()</span>
<span class="n">shape_collection</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">calibration</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">fig_size</span> <span class="o">=</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="n">save_name</span><span class="o">=</span><span class="s1">&#39;conv40.png&#39;</span><span class="p">)</span>

<span class="n">loader_config</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;orientation_transform&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]]),</span>
    <span class="s1">&#39;shape_dilation&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
    <span class="s1">&#39;binary_smoothing&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
    <span class="s1">&#39;poly_compression_factor&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="s1">&#39;path_optimization&#39;</span><span class="p">:</span> <span class="s1">&#39;hilbert&#39;</span><span class="p">,</span>
    <span class="s1">&#39;convolution_smoothing&#39;</span><span class="p">:</span><span class="mi">80</span><span class="p">,</span>
    <span class="s1">&#39;join_intersecting&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
    <span class="s1">&#39;background_image&#39;</span><span class="p">:</span> <span class="n">dapi</span>
<span class="p">}</span>

<span class="n">sl</span> <span class="o">=</span> <span class="n">SegmentationLoader</span><span class="p">(</span><span class="n">config</span> <span class="o">=</span> <span class="n">loader_config</span><span class="p">,</span> <span class="n">verbose</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
<span class="n">shape_collection</span> <span class="o">=</span> <span class="n">sl</span><span class="p">(</span><span class="n">segmentation</span><span class="p">,</span>
                    <span class="n">cell_sets</span><span class="p">,</span>
                    <span class="n">calibration_points</span><span class="p">)</span>

<span class="n">shape_collection</span><span class="o">.</span><span class="n">stats</span><span class="p">()</span>
<span class="n">shape_collection</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">calibration</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">fig_size</span> <span class="o">=</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="n">save_name</span><span class="o">=</span><span class="s1">&#39;conv80.png&#39;</span><span class="p">)</span>
<br/><br/><br/></pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">PIL</span> <span class="kn">import</span> <span class="n">Image</span>
<span class="kn">from</span> <span class="nn">lmd.lib</span> <span class="kn">import</span> <span class="n">Collection</span><span class="p">,</span> <span class="n">Shape</span><span class="p">,</span> <span class="n">SegmentationLoader</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

<span class="n">im</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;segmentation_cytosol.tiff&#39;</span><span class="p">)</span>
<span class="n">segmentation</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">im</span><span class="p">)</span>

<span class="n">im</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;channels.npy&#39;</span><span class="p">)</span>
<span class="n">dapi</span> <span class="o">=</span> <span class="n">im</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="n">all_classes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">segmentation</span><span class="p">)</span>
<span class="n">indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">all_classes</span><span class="p">),</span> <span class="n">size</span><span class="o">=</span><span class="mi">100</span><span class="p">))</span>
<span class="n">classes_to_cut</span> <span class="o">=</span> <span class="p">[</span><span class="mi">13</span><span class="p">,</span><span class="mi">15</span><span class="p">,</span><span class="mi">23</span><span class="p">,</span><span class="mi">24</span><span class="p">,</span><span class="mi">25</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">36</span><span class="p">]</span>


<span class="n">cell_sets</span> <span class="o">=</span> <span class="p">[{</span><span class="s2">&quot;classes&quot;</span><span class="p">:</span> <span class="n">classes_to_cut</span><span class="p">,</span> <span class="s2">&quot;well&quot;</span><span class="p">:</span> <span class="s2">&quot;A1&quot;</span><span class="p">}]</span>

<span class="n">calibration_points</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1000</span><span class="p">],[</span><span class="mi">1000</span><span class="p">,</span><span class="mi">1000</span><span class="p">]])</span>

<span class="n">loader_config</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;orientation_transform&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]]),</span>
    <span class="s1">&#39;shape_dilation&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
    <span class="s1">&#39;binary_smoothing&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
    <span class="s1">&#39;poly_compression_factor&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="s1">&#39;path_optimization&#39;</span><span class="p">:</span> <span class="s1">&#39;hilbert&#39;</span><span class="p">,</span>
    <span class="s1">&#39;convolution_smoothing&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span>
    <span class="s1">&#39;join_intersecting&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
    <span class="s1">&#39;background_image&#39;</span><span class="p">:</span> <span class="n">dapi</span>
<span class="p">}</span>

<span class="n">sl</span> <span class="o">=</span> <span class="n">SegmentationLoader</span><span class="p">(</span><span class="n">config</span> <span class="o">=</span> <span class="n">loader_config</span><span class="p">,</span> <span class="n">verbose</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
<span class="n">shape_collection</span> <span class="o">=</span> <span class="n">sl</span><span class="p">(</span><span class="n">segmentation</span><span class="p">,</span>
                    <span class="n">cell_sets</span><span class="p">,</span>
                    <span class="n">calibration_points</span><span class="p">)</span>

<span class="n">shape_collection</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">calibration</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">fig_size</span> <span class="o">=</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="n">save_name</span><span class="o">=</span><span class="s1">&#39;bin0.png&#39;</span><span class="p">)</span>

<span class="n">loader_config</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;orientation_transform&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]]),</span>
    <span class="s1">&#39;shape_dilation&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
    <span class="s1">&#39;binary_smoothing&#39;</span><span class="p">:</span> <span class="mi">15</span><span class="p">,</span>
    <span class="s1">&#39;poly_compression_factor&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="s1">&#39;path_optimization&#39;</span><span class="p">:</span> <span class="s1">&#39;hilbert&#39;</span><span class="p">,</span>
    <span class="s1">&#39;convolution_smoothing&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span>
    <span class="s1">&#39;join_intersecting&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
    <span class="s1">&#39;background_image&#39;</span><span class="p">:</span> <span class="n">dapi</span>
<span class="p">}</span>

<span class="n">sl</span> <span class="o">=</span> <span class="n">SegmentationLoader</span><span class="p">(</span><span class="n">config</span> <span class="o">=</span> <span class="n">loader_config</span><span class="p">,</span> <span class="n">verbose</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
<span class="n">shape_collection</span> <span class="o">=</span> <span class="n">sl</span><span class="p">(</span><span class="n">segmentation</span><span class="p">,</span>
                    <span class="n">cell_sets</span><span class="p">,</span>
                    <span class="n">calibration_points</span><span class="p">)</span>

<span class="n">shape_collection</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">calibration</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">fig_size</span> <span class="o">=</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="n">save_name</span><span class="o">=</span><span class="s1">&#39;bin15.png&#39;</span><span class="p">)</span>

<span class="n">loader_config</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;orientation_transform&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]]),</span>
    <span class="s1">&#39;shape_dilation&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
    <span class="s1">&#39;binary_smoothing&#39;</span><span class="p">:</span> <span class="mi">30</span><span class="p">,</span>
    <span class="s1">&#39;poly_compression_factor&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="s1">&#39;path_optimization&#39;</span><span class="p">:</span> <span class="s1">&#39;hilbert&#39;</span><span class="p">,</span>
    <span class="s1">&#39;convolution_smoothing&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span>
    <span class="s1">&#39;join_intersecting&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
    <span class="s1">&#39;background_image&#39;</span><span class="p">:</span> <span class="n">dapi</span>
<span class="p">}</span>

<span class="n">sl</span> <span class="o">=</span> <span class="n">SegmentationLoader</span><span class="p">(</span><span class="n">config</span> <span class="o">=</span> <span class="n">loader_config</span><span class="p">,</span> <span class="n">verbose</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
<span class="n">shape_collection</span> <span class="o">=</span> <span class="n">sl</span><span class="p">(</span><span class="n">segmentation</span><span class="p">,</span>
                    <span class="n">cell_sets</span><span class="p">,</span>
                    <span class="n">calibration_points</span><span class="p">)</span>

<span class="n">shape_collection</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">calibration</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">fig_size</span> <span class="o">=</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="n">save_name</span><span class="o">=</span><span class="s1">&#39;bin30.png&#39;</span><span class="p">)</span>
<br/><br/><br/></pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">PIL</span> <span class="kn">import</span> <span class="n">Image</span>
<span class="kn">from</span> <span class="nn">lmd.lib</span> <span class="kn">import</span> <span class="n">Collection</span><span class="p">,</span> <span class="n">Shape</span><span class="p">,</span> <span class="n">SegmentationLoader</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

<span class="n">im</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;segmentation_cytosol.tiff&#39;</span><span class="p">)</span>
<span class="n">segmentation</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">im</span><span class="p">)</span>

<span class="n">im</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;channels.npy&#39;</span><span class="p">)</span>
<span class="n">dapi</span> <span class="o">=</span> <span class="n">im</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="n">all_classes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">segmentation</span><span class="p">)</span>
<span class="n">indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">all_classes</span><span class="p">),</span> <span class="n">size</span><span class="o">=</span><span class="mi">100</span><span class="p">))</span>
<span class="n">classes_to_cut</span> <span class="o">=</span> <span class="p">[</span><span class="mi">13</span><span class="p">,</span><span class="mi">15</span><span class="p">,</span><span class="mi">23</span><span class="p">,</span><span class="mi">24</span><span class="p">,</span><span class="mi">25</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">36</span><span class="p">]</span>


<span class="n">cell_sets</span> <span class="o">=</span> <span class="p">[{</span><span class="s2">&quot;classes&quot;</span><span class="p">:</span> <span class="n">classes_to_cut</span><span class="p">,</span> <span class="s2">&quot;well&quot;</span><span class="p">:</span> <span class="s2">&quot;A1&quot;</span><span class="p">}]</span>

<span class="n">calibration_points</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1000</span><span class="p">],[</span><span class="mi">1000</span><span class="p">,</span><span class="mi">1000</span><span class="p">]])</span>

<span class="n">loader_config</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;orientation_transform&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]]),</span>
    <span class="s1">&#39;shape_dilation&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
    <span class="s1">&#39;binary_smoothing&#39;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span>
    <span class="s1">&#39;poly_compression_factor&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="s1">&#39;path_optimization&#39;</span><span class="p">:</span> <span class="s1">&#39;hilbert&#39;</span><span class="p">,</span>
    <span class="s1">&#39;convolution_smoothing&#39;</span><span class="p">:</span><span class="mi">20</span><span class="p">,</span>
    <span class="s1">&#39;join_intersecting&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
    <span class="s1">&#39;background_image&#39;</span><span class="p">:</span> <span class="n">dapi</span>
<span class="p">}</span>

<span class="n">sl</span> <span class="o">=</span> <span class="n">SegmentationLoader</span><span class="p">(</span><span class="n">config</span> <span class="o">=</span> <span class="n">loader_config</span><span class="p">,</span> <span class="n">verbose</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
<span class="n">shape_collection</span> <span class="o">=</span> <span class="n">sl</span><span class="p">(</span><span class="n">segmentation</span><span class="p">,</span>
                    <span class="n">cell_sets</span><span class="p">,</span>
                    <span class="n">calibration_points</span><span class="p">)</span>

<span class="n">shape_collection</span><span class="o">.</span><span class="n">stats</span><span class="p">()</span>
<span class="n">shape_collection</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">calibration</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">fig_size</span> <span class="o">=</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="n">save_name</span><span class="o">=</span><span class="s1">&#39;comp1.png&#39;</span><span class="p">)</span>
<span class="n">shape_collection</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">calibration</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">fig_size</span> <span class="o">=</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="n">save_name</span><span class="o">=</span><span class="s1">&#39;comp_dots1.png&#39;</span> <span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;dots&#39;</span><span class="p">)</span>

<span class="n">loader_config</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;orientation_transform&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]]),</span>
    <span class="s1">&#39;shape_dilation&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
    <span class="s1">&#39;binary_smoothing&#39;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span>
    <span class="s1">&#39;poly_compression_factor&#39;</span><span class="p">:</span> <span class="mi">20</span><span class="p">,</span>
    <span class="s1">&#39;path_optimization&#39;</span><span class="p">:</span> <span class="s1">&#39;hilbert&#39;</span><span class="p">,</span>
    <span class="s1">&#39;convolution_smoothing&#39;</span><span class="p">:</span><span class="mi">20</span><span class="p">,</span>
    <span class="s1">&#39;join_intersecting&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
    <span class="s1">&#39;background_image&#39;</span><span class="p">:</span> <span class="n">dapi</span>
<span class="p">}</span>

<span class="n">sl</span> <span class="o">=</span> <span class="n">SegmentationLoader</span><span class="p">(</span><span class="n">config</span> <span class="o">=</span> <span class="n">loader_config</span><span class="p">,</span> <span class="n">verbose</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
<span class="n">shape_collection</span> <span class="o">=</span> <span class="n">sl</span><span class="p">(</span><span class="n">segmentation</span><span class="p">,</span>
                    <span class="n">cell_sets</span><span class="p">,</span>
                    <span class="n">calibration_points</span><span class="p">)</span>

<span class="n">shape_collection</span><span class="o">.</span><span class="n">stats</span><span class="p">()</span>
<span class="n">shape_collection</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">calibration</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">fig_size</span> <span class="o">=</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="n">save_name</span><span class="o">=</span><span class="s1">&#39;comp20.png&#39;</span><span class="p">)</span>
<span class="n">shape_collection</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">calibration</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">fig_size</span> <span class="o">=</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="n">save_name</span><span class="o">=</span><span class="s1">&#39;comp_dots20.png&#39;</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;dots&#39;</span><span class="p">)</span>

<span class="n">loader_config</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;orientation_transform&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]]),</span>
    <span class="s1">&#39;shape_dilation&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
    <span class="s1">&#39;binary_smoothing&#39;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span>
    <span class="s1">&#39;poly_compression_factor&#39;</span><span class="p">:</span> <span class="mi">40</span><span class="p">,</span>
    <span class="s1">&#39;path_optimization&#39;</span><span class="p">:</span> <span class="s1">&#39;hilbert&#39;</span><span class="p">,</span>
    <span class="s1">&#39;convolution_smoothing&#39;</span><span class="p">:</span><span class="mi">20</span><span class="p">,</span>
    <span class="s1">&#39;join_intersecting&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
    <span class="s1">&#39;background_image&#39;</span><span class="p">:</span> <span class="n">dapi</span>
<span class="p">}</span>

<span class="n">sl</span> <span class="o">=</span> <span class="n">SegmentationLoader</span><span class="p">(</span><span class="n">config</span> <span class="o">=</span> <span class="n">loader_config</span><span class="p">,</span> <span class="n">verbose</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
<span class="n">shape_collection</span> <span class="o">=</span> <span class="n">sl</span><span class="p">(</span><span class="n">segmentation</span><span class="p">,</span>
                    <span class="n">cell_sets</span><span class="p">,</span>
                    <span class="n">calibration_points</span><span class="p">)</span>

<span class="n">shape_collection</span><span class="o">.</span><span class="n">stats</span><span class="p">()</span>
<span class="n">shape_collection</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">calibration</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">fig_size</span> <span class="o">=</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="n">save_name</span><span class="o">=</span><span class="s1">&#39;comp40.png&#39;</span><span class="p">)</span>
<span class="n">shape_collection</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">calibration</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">fig_size</span> <span class="o">=</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="n">save_name</span><span class="o">=</span><span class="s1">&#39;comp_dots40.png&#39;</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;dots&#39;</span><span class="p">)</span>
<br/><br/><br/></pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">PIL</span> <span class="kn">import</span> <span class="n">Image</span>
<span class="kn">from</span> <span class="nn">lmd.lib</span> <span class="kn">import</span> <span class="n">Collection</span><span class="p">,</span> <span class="n">Shape</span><span class="p">,</span> <span class="n">SegmentationLoader</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

<span class="n">im</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;segmentation_cytosol.tiff&#39;</span><span class="p">)</span>
<span class="n">segmentation</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">im</span><span class="p">)</span>

<span class="n">im</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;channels.npy&#39;</span><span class="p">)</span>
<span class="n">dapi</span> <span class="o">=</span> <span class="n">im</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="n">all_classes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">segmentation</span><span class="p">)</span>
<span class="n">indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">all_classes</span><span class="p">),</span> <span class="n">size</span><span class="o">=</span><span class="mi">100</span><span class="p">))</span>
<span class="n">classes_to_cut</span> <span class="o">=</span> <span class="p">[</span><span class="mi">13</span><span class="p">,</span><span class="mi">15</span><span class="p">,</span><span class="mi">23</span><span class="p">,</span><span class="mi">24</span><span class="p">,</span><span class="mi">25</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">36</span><span class="p">]</span>


<span class="n">cell_sets</span> <span class="o">=</span> <span class="p">[{</span><span class="s2">&quot;classes&quot;</span><span class="p">:</span> <span class="n">classes_to_cut</span><span class="p">,</span> <span class="s2">&quot;well&quot;</span><span class="p">:</span> <span class="s2">&quot;A1&quot;</span><span class="p">}]</span>

<span class="n">calibration_points</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1000</span><span class="p">],[</span><span class="mi">1000</span><span class="p">,</span><span class="mi">1000</span><span class="p">]])</span>

<span class="n">loader_config</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;orientation_transform&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]]),</span>
    <span class="s1">&#39;shape_erosion&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>
    <span class="s1">&#39;shape_dilation&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
    <span class="s1">&#39;binary_smoothing&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
    <span class="s1">&#39;poly_compression_factor&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="s1">&#39;path_optimization&#39;</span><span class="p">:</span> <span class="s1">&#39;hilbert&#39;</span><span class="p">,</span>
    <span class="s1">&#39;convolution_smoothing&#39;</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span>
    <span class="s1">&#39;join_intersecting&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
    <span class="s1">&#39;background_image&#39;</span><span class="p">:</span> <span class="n">dapi</span>
<span class="p">}</span>

<span class="n">sl</span> <span class="o">=</span> <span class="n">SegmentationLoader</span><span class="p">(</span><span class="n">config</span> <span class="o">=</span> <span class="n">loader_config</span><span class="p">,</span> <span class="n">verbose</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
<span class="n">shape_collection</span> <span class="o">=</span> <span class="n">sl</span><span class="p">(</span><span class="n">segmentation</span><span class="p">,</span>
                    <span class="n">cell_sets</span><span class="p">,</span>
                    <span class="n">calibration_points</span><span class="p">)</span>

<span class="n">shape_collection</span><span class="o">.</span><span class="n">stats</span><span class="p">()</span>
<span class="n">shape_collection</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">calibration</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">fig_size</span> <span class="o">=</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>

<span class="n">loader_config</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;orientation_transform&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]]),</span>
    <span class="s1">&#39;shape_dilation&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>
    <span class="s1">&#39;binary_smoothing&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
    <span class="s1">&#39;poly_compression_factor&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="s1">&#39;path_optimization&#39;</span><span class="p">:</span> <span class="s1">&#39;hilbert&#39;</span><span class="p">,</span>
    <span class="s1">&#39;convolution_smoothing&#39;</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span>
    <span class="s1">&#39;join_intersecting&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
    <span class="s1">&#39;background_image&#39;</span><span class="p">:</span> <span class="n">dapi</span>
<span class="p">}</span>

<span class="n">sl</span> <span class="o">=</span> <span class="n">SegmentationLoader</span><span class="p">(</span><span class="n">config</span> <span class="o">=</span> <span class="n">loader_config</span><span class="p">,</span> <span class="n">verbose</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
<span class="n">shape_collection</span> <span class="o">=</span> <span class="n">sl</span><span class="p">(</span><span class="n">segmentation</span><span class="p">,</span>
                    <span class="n">cell_sets</span><span class="p">,</span>
                    <span class="n">calibration_points</span><span class="p">)</span>

<span class="n">shape_collection</span><span class="o">.</span><span class="n">stats</span><span class="p">()</span>
<span class="n">shape_collection</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">calibration</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">fig_size</span> <span class="o">=</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>

<span class="n">loader_config</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;orientation_transform&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]]),</span>
    <span class="s1">&#39;shape_dilation&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>
    <span class="s1">&#39;binary_smoothing&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
    <span class="s1">&#39;poly_compression_factor&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="s1">&#39;path_optimization&#39;</span><span class="p">:</span> <span class="s1">&#39;hilbert&#39;</span><span class="p">,</span>
    <span class="s1">&#39;convolution_smoothing&#39;</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span>
    <span class="s1">&#39;join_intersecting&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
    <span class="s1">&#39;background_image&#39;</span><span class="p">:</span> <span class="n">dapi</span>
<span class="p">}</span>

<span class="n">sl</span> <span class="o">=</span> <span class="n">SegmentationLoader</span><span class="p">(</span><span class="n">config</span> <span class="o">=</span> <span class="n">loader_config</span><span class="p">,</span> <span class="n">verbose</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
<span class="n">shape_collection</span> <span class="o">=</span> <span class="n">sl</span><span class="p">(</span><span class="n">segmentation</span><span class="p">,</span>
                    <span class="n">cell_sets</span><span class="p">,</span>
                    <span class="n">calibration_points</span><span class="p">)</span>

<span class="n">shape_collection</span><span class="o">.</span><span class="n">stats</span><span class="p">()</span>
<span class="n">shape_collection</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">calibration</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">fig_size</span> <span class="o">=</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<br/><br/><br/></pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">off</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">10</span><span class="p">,</span> <span class="o">-</span><span class="mi">8</span><span class="p">])</span>
<span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">off</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023 Georg Wallmann, Sophia Mdler and Niklas Schmacke.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>